
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PROYEK SAINS DATA PREDIKSI DETAK JANTUNG UNTUK DETEKSI DINI KEGAGALAN JANTUNG PASIEN KOGNESTIF BERAT &#8212; PSD-Tugas Akhir</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Project3';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="PROYEK SAINS DATA PREDIKSI EMISI CO2 PER TAHUN NEGARA INDONESIA BERDASARKAN POLA WAKTU" href="Project2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/portofolio.png" class="logo__image only-light" alt="PSD-Tugas Akhir - Home"/>
    <script>document.write(`<img src="_static/portofolio.png" class="logo__image only-dark" alt="PSD-Tugas Akhir - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Tugas Akir Proyek Sains Data
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Project1.html">PROYEK SAINS DATA PREDIKSI PRODUKSI PADI KOTA SURABAYA MENGGUNAKAN DATA CUACA UNTUK MENSTABILKAN KETAHANAN PANGAN</a></li>








<li class="toctree-l1"><a class="reference internal" href="Project2.html">PROYEK SAINS DATA PREDIKSI EMISI CO2 PER TAHUN NEGARA INDONESIA BERDASARKAN POLA WAKTU</a></li>







<li class="toctree-l1 current active"><a class="current reference internal" href="#">PROYEK SAINS DATA PREDIKSI DETAK JANTUNG UNTUK DETEKSI DINI KEGAGALAN JANTUNG PASIEN KOGNESTIF BERAT</a></li>








</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FProject3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Project3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PROYEK SAINS DATA PREDIKSI DETAK JANTUNG UNTUK DETEKSI DINI KEGAGALAN JANTUNG PASIEN KOGNESTIF BERAT</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">PROYEK SAINS DATA PREDIKSI DETAK JANTUNG UNTUK DETEKSI DINI KEGAGALAN JANTUNG PASIEN KOGNESTIF BERAT</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bisnis-understading">Bisnis Understading</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#latar-belakang">1. Latar Belakang</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rumusan-masalah">2. Rumusan Masalah</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan">3. Tujuan</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-collecting">Data Collecting</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ekstraksi-fitur">Ekstraksi Fitur</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">Data Understanding</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kualitas-data">Kualitas Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribusi-data">Distribusi data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-value">Missing Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#korekasi-fitur">Korekasi fitur</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outlier">Outlier</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-prepocessing">Data Prepocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mengatasi-outlier">Mengatasi Outlier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seleksi-fitur">Seleksi Fitur</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menyiapkan-data-untuk-recursive-multi-step-forecasting">Menyiapkan Data untuk Recursive Multi-step Forecasting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-fitur">Lag Fitur</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#horizon-target">Horizon / Target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#membagi-data-train-dan-test">Membagi data train dan test</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">Modelling</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fungsi-rekursif-forcasts">Fungsi Rekursif Forcasts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest-regressor">1. Random Forest Regressor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#svr">2. SVR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gradient-boost">3. Gradient Boost</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#kesimpulan">Kesimpulan</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#deployment">Deployment</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#website">Website</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="proyek-sains-data-prediksi-detak-jantung-untuk-deteksi-dini-kegagalan-jantung-pasien-kognestif-berat">
<h1>PROYEK SAINS DATA PREDIKSI DETAK JANTUNG UNTUK DETEKSI DINI KEGAGALAN JANTUNG PASIEN KOGNESTIF BERAT<a class="headerlink" href="#proyek-sains-data-prediksi-detak-jantung-untuk-deteksi-dini-kegagalan-jantung-pasien-kognestif-berat" title="Link to this heading">#</a></h1>
<p>Dataset : BIDMC Congestive Heart Failure Database
<a class="reference external" href="https://physionet.org/content/chfdb/1.0.0/">https://physionet.org/content/chfdb/1.0.0/</a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="bisnis-understading">
<h1>Bisnis Understading<a class="headerlink" href="#bisnis-understading" title="Link to this heading">#</a></h1>
<section id="latar-belakang">
<h2>1. Latar Belakang<a class="headerlink" href="#latar-belakang" title="Link to this heading">#</a></h2>
<p>Kegagalan Jantung Kongestif (CHF) adalah salah satu kondisi medis kronis yang paling umum dan serius di seluruh dunia. Organisasi Kesehatan Dunia (WHO) melaporkan bahwa CHF memengaruhi jutaan orang setiap tahunnya dan merupakan salah satu penyebab utama kematian dan beban kesehatan di seluruh dunia. Seiring bertambahnya usia penduduk dan perubahan gaya hidup, seperti pola makan yang tidak sehat dan tingkat aktivitas fisik yang rendah, prevalensi CHF di Indonesia terus meningkat.</p>
<p>Ketika jantung tidak dapat memompa darah secara efektif untuk memenuhi kebutuhan tubuh, cairan terkumpul di paru-paru, hati, dan jaringan tubuh lainnya. Ini menyebabkan CHF. Gejala serius seperti sesak napas, kelelahan, dan pembengkakan pada kaki dapat menyebabkan CHF yang lebih parah, yang dapat meningkatkan angka kematian dan kualitas hidup pasien.</p>
<p>Untuk meningkatkan prognosis pasien dan mencegah komplikasi serius, deteksi dini CHF sangat penting. Namun, ini seringkali sulit karena gejala awal CHF seringkali tidak spesifik dan mirip dengan kondisi medis lainnya. Akibatnya, metode yang lebih efisien dan akurat diperlukan untuk mengidentifikasi CHF pada tahap awal.</p>
<p>Salah satu cara penting untuk mengetahui seberapa baik kesehatan jantung dan sistem kardiovaskular secara keseluruhan adalah dengan melihat detak jantung, atau detak jantung. Ada bukti bahwa variabilitas detak jantung, juga dikenal sebagai variabilitas detak jantung (HRV), merupakan biomarker penting untuk memantau kesehatan jantung. Jika ada perubahan dalam pola detak jantung, seperti peningkatan atau penurunan yang tidak wajar, ini dapat menjadi tanda bahwa ada masalah dengan fungsi jantung.</p>
<p>Penelitian telah menunjukkan bahwa pasien dengan CHF sering mengalami perubahan signifikan dalam detak jantung mereka. Misalnya, peningkatan detak jantung dapat menunjukkan bahwa jantung bekerja lebih keras untuk memompa darah, sementara penurunan detak jantung dapat menunjukkan bahwa jantung tidak mampu memompa darah sebanyak yang dibutuhkannya. Oleh karena itu, analisis detak jantung dapat menjadi cara yang bagus untuk menemukan kegagalan jantung sejak dini.</p>
<p>Data sains telah menjadi alat penting dalam bidang kesehatan di era digitalisasi, khususnya dalam deteksi dan prediksi kondisi medis jangka panjang seperti CHF. Para peneliti dapat menemukan pola dan tren yang tidak terlihat oleh analisis tradisional dengan menggunakan teknik machine learning dan analisis data besar.</p>
<p>Tenaga medis dapat mendapat manfaat dari proyek sains data yang berfokus pada prediksi detak jantung untuk deteksi CHF dini. Model prediktif yang akurat dapat membantu keputusan klinis, memungkinkan intervensi yang lebih cepat, dan menyesuaikan perawatan pasien dengan lebih baik. Teknologi ini juga dapat meningkatkan efisiensi operasional dan mengurangi biaya perawatan jangka panjang.</p>
<p>Data fisiologis pasien, seperti rekaman elektrokardiogram (ECG), detak jantung, interval RR, dan berbagai parameter lainnya yang terkait dengan kondisi jantung pasien, termasuk dalam BIDMC Congestive Heart Failure Database, yang merupakan salah satu dataset yang paling komprehensif dan banyak digunakan dalam penelitian tentang penyakit jantung koroner (CHF).</p>
<p>Dataset ini memiliki lebih dari 1200 entri data, yang memberikan basis yang kuat untuk pengembangan model prediktif dan ekstraksi fitur. Sifat-sifat seperti rata-rata, standar deviasi, nilai maksimum dan minimum sinyal elektrokardiogram, serta interval RR dan detak jantung per menit (bpm) memberikan informasi mendalam yang dapat digunakan untuk mengidentifikasi pola yang terkait dengan CHF.</p>
</section>
<section id="rumusan-masalah">
<h2>2. Rumusan Masalah<a class="headerlink" href="#rumusan-masalah" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Bagaimana Memprediksi Risiko Kegagalan Jantung pada Pasien Kongestif Berat Berdasarkan Data Detak Jantung?
Deskripsi: Meskipun detak jantung ada</p></li>
<li><p>Sejauh Mana Model Prediktif Dapat Diintegrasikan ke dalam Praktik Klinis untuk Mendukung Deteksi Dini Kegagalan Jantung?</p></li>
<li><p>Bagaimana Mengukur dan Memvalidasi Kinerja Model Prediktif dalam Konteks Deteksi Dini Kegagalan Jantung?</p></li>
</ul>
</section>
<section id="tujuan">
<h2>3. Tujuan<a class="headerlink" href="#tujuan" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Membangun dan melatih model machine learning yang dapat memprediksi risiko kegagalan jantung berdasarkan data fisiologis yang tersedia.</p></li>
<li><p>Menggunakan algoritma yang sesuai untuk mencapai akurasi prediksi yang optimal.</p></li>
<li><p>Menganalisis hasil prediksi model untuk mengidentifikasi faktor-faktor utama yang mempengaruhi risiko kegagalan jantung.</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-collecting">
<h1>Data Collecting<a class="headerlink" href="#data-collecting" title="Link to this heading">#</a></h1>
<p>Basis data ini mencakup rekaman EKG jangka panjang dari 15 subjek (11 pria, berusia 22 hingga 71 tahun, dan 4 wanita, berusia 54 hingga 63 tahun) dengan gagal jantung kongestif berat (kelas NYHA 3–4). Kelompok subjek ini merupakan bagian dari kelompok studi yang lebih besar yang menerima terapi medis konvensional sebelum menerima agen inotropik oral, milrinon. Rincian lebih lanjut tentang kelompok studi yang lebih besar tersedia dalam referensi pertama yang dikutip di atas. Sejumlah studi tambahan telah menggunakan rekaman ini; lihat referensi tambahan di bawah ini.</p>
<p>Rekaman individual masing-masing berdurasi sekitar 20 jam, dan berisi dua sinyal EKG yang masing-masing diambil sampelnya pada 250 sampel per detik dengan resolusi 12-bit pada rentang ±10 milivolt. Rekaman analog asli dibuat di Rumah Sakit Beth Israel Boston (sekarang Beth Israel Deaconess Medical Center) menggunakan perekam EKG ambulatori dengan lebar pita perekaman tipikal sekitar 0,1 Hz hingga 40 Hz. File anotasi (dengan sufiks .ecg) disiapkan menggunakan detektor otomatis dan belum dikoreksi secara manual.</p>
<section id="ekstraksi-fitur">
<h2>Ekstraksi Fitur<a class="headerlink" href="#ekstraksi-fitur" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">wfdb</span> <span class="c1"># type: ignore</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># type: ignore</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># type: ignore</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">scipy.signal</span> <span class="kn">import</span> <span class="n">find_peaks</span> <span class="c1"># type: ignore</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># type: ignore</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">wfdb</span> <span class="c1"># type: ignore</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># type: ignore</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># type: ignore</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;wfdb&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># record_name = &#39;chf14&#39;</span>
<span class="c1"># record_path = &#39;files/&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Baca Rekaman ECG</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># record = wfdb.rdrecord(record_path + record_name)</span>
<span class="c1"># signal = record.p_signal  # Bentuk (n_samples, n_channels)</span>
<span class="c1"># fs = record.fs            # Sampling rate, biasanya 250 Hz</span>
<span class="c1"># print(f&quot;Sampling rate: {fs} Hz&quot;)</span>
</pre></div>
</div>
</div>
</div>
<p>Sinyal ECG direkam dengan sampling rate (f_s) (Hz). Waktu untuk setiap sampel dihitung sebagai:</p>
<div class="math notranslate nohighlight">
\[
t[i] = \frac{i}{f_s}
\]</div>
<ul class="simple">
<li><p>(t[i]): Waktu pada sampel ke-(i) (dalam detik).</p></li>
<li><p>(f_s): Sampling rate (contoh: 250 Hz).</p></li>
</ul>
<p>baca Anotasi R-peaks</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># try:</span>
<span class="c1">#     annotation = wfdb.rdann(record_path + record_name, &#39;ecg&#39;)</span>
<span class="c1">#     r_peaks = annotation.sample</span>
<span class="c1">#     print(f&quot;R-peaks dari anotasi: {len(r_peaks)} puncak&quot;)</span>
<span class="c1"># except Exception as e:</span>
<span class="c1">#     print(&quot;Anotasi tidak ditemukan atau tidak dapat dibaca. Melakukan deteksi R-peaks manual.&quot;)</span>
<span class="c1">#     # Memilih salah satu channel ECG, misalnya lead 1 (channel 0)</span>
<span class="c1">#     ecg_signal = signal[:, 0]</span>
    
<span class="c1">#     peaks, properties = find_peaks(</span>
<span class="c1">#         ecg_signal, </span>
<span class="c1">#         height=np.mean(ecg_signal) + 0.5 * np.std(ecg_signal), </span>
<span class="c1">#         distance=fs * 0.4  # minimal 0.4 detik antar R-peaks</span>
<span class="c1">#     )</span>
<span class="c1">#     r_peaks = peaks</span>
<span class="c1">#     print(f&quot;R-peaks terdeteksi secara manual: {len(r_peaks)} puncak&quot;)</span>
</pre></div>
</div>
</div>
</div>
<p>Jika anotasi R-peaks tersedia, nilai langsung diambil. Namun, jika tidak, deteksi manual dilakukan dengan:</p>
<ol class="arabic simple">
<li><p><strong>Ambang Deteksi</strong>:
$<span class="math notranslate nohighlight">\(
\text{threshold} = \mu_{\text{ECG}} + 0.5 \cdot \sigma_{\text{ECG}}
\)</span>$</p></li>
</ol>
<ul>
<li><div class="math notranslate nohighlight">
\[ \mu\text{ECG} = \text{Rata-rata amplitudo sinyal ECG.} \]</div>
</li>
<li><div class="math notranslate nohighlight">
\[ \sigma\text{ECG} = \text{Standar Deviasi sinyal ECG.} \]</div>
</li>
</ul>
<ol class="arabic simple" start="2">
<li><p><strong>Jarak Minimum Antar Puncak</strong>:
$<span class="math notranslate nohighlight">\(
\text{distance} = f_s \cdot 0.4
\)</span>$</p></li>
</ol>
<ul class="simple">
<li><p>0.4 detik adalah jarak minimum antar detak jantung (aturan fisiologis).</p></li>
</ul>
<p>Menghitung RR_Interval dan HR (Heart Rate)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># n_samples = signal.shape[0]</span>
<span class="c1"># time = np.arange(n_samples) / fs  </span>

<span class="c1"># RR_intervals = np.diff(r_peaks) / fs   </span>
<span class="c1"># heart_rate = 60 / RR_intervals         </span>
<span class="c1"># time_hr = time[r_peaks[1:]]    </span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>Menghitung RR Interval</p></li>
</ol>
<p>RR interval adalah selisih waktu antar R-peaks:</p>
<div class="math notranslate nohighlight">
\[
RR[i] = \frac{r[i+1] - r[i]}{f_s}
\]</div>
<ul class="simple">
<li><p>(RR[i]): RR interval ke-(i) (dalam detik).</p></li>
<li><p>(r[i]): Indeks sampel dari R-peak ke-(i).</p></li>
<li><p>(f_s): Sampling rate.</p></li>
</ul>
<ol class="arabic simple" start="4">
<li><p>Menghitung Heart Rate (HR)</p></li>
</ol>
<p>Heart rate dihitung sebagai:</p>
<div class="math notranslate nohighlight">
\[
\text{HR}[i] = \frac{60}{RR[i]}
\]</div>
<ul class="simple">
<li><p>(\text{HR}[i]): Heart rate pada interval ke-(i) (dalam beats per minute atau BPM).</p></li>
<li><p>60: Konversi dari detik ke menit.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Membuat DataFrame ECG</span>
<span class="c1"># df_ecg = pd.DataFrame({</span>
<span class="c1">#     &#39;time_s&#39;: time,</span>
<span class="c1">#     &#39;ecg_lead1_mV&#39;: signal[:, 0],</span>
<span class="c1">#     &#39;ecg_lead2_mV&#39;: signal[:, 1]</span>
<span class="c1"># })</span>

<span class="c1"># # Membuat DataFrame Heart Rate</span>
<span class="c1"># df_hr = pd.DataFrame({</span>
<span class="c1">#     &#39;time_s&#39;: time_hr,</span>
<span class="c1">#     &#39;heart_rate_bpm&#39;: heart_rate,</span>
<span class="c1">#     &#39;RR_interval_s&#39;: RR_intervals</span>
<span class="c1"># })</span>

<span class="c1"># # Menyimpan DataFrame Awal ke CSV (Opsional)</span>
<span class="c1"># df_ecg.to_csv(&#39;chf15_ecg_timeseries.csv&#39;, index=False)</span>
<span class="c1"># df_hr.to_csv(&#39;chf15_heart_rate_rr.csv&#39;, index=False)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_hr[&#39;time_s&#39;] = pd.to_timedelta(df_hr[&#39;time_s&#39;], unit=&#39;s&#39;)</span>

<span class="c1"># print(&quot;\nSetelah konversi &#39;time_s&#39; ke Timedelta:&quot;)</span>
<span class="c1"># print(df_hr[&#39;time_s&#39;].head())</span>
<span class="c1"># print(df_hr[&#39;time_s&#39;].dtype)</span>

<span class="c1"># df_hr.set_index(&#39;time_s&#39;, inplace=True)</span>
</pre></div>
</div>
</div>
</div>
<p>Resampling data ke menit</p>
<ol class="arabic simple" start="6">
<li><p>Resampling dan Penggabungan
Resampling Heart Rate
Heart rate diambil rata-rata setiap menit dengan interpolasi linier:
$<span class="math notranslate nohighlight">\(
\text{HR}_{\text{resampled}}[t] = \text{mean}(\text{HR}[t_1:t_n])
\)</span>$</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_hr_resampled = df_hr.resample(&#39;1T&#39;).mean().interpolate()</span>

<span class="c1"># df_hr_resampled.reset_index(inplace=True)</span>
<span class="c1"># df_hr_resampled[&#39;time_s&#39;] = df_hr_resampled[&#39;time_s&#39;].dt.total_seconds()</span>

<span class="c1"># print(&quot;\nDataFrame Heart Rate setelah Resampling Per Menit:&quot;)</span>
<span class="c1"># print(df_hr_resampled.head())</span>
<span class="c1"># print(df_hr_resampled.dtypes)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Agregasi DataFrame ECG per Menit</span>
<span class="c1"># df_ecg[&#39;time_s_td&#39;] = pd.to_timedelta(df_ecg[&#39;time_s&#39;], unit=&#39;s&#39;)</span>
<span class="c1"># df_ecg.set_index(&#39;time_s_td&#39;, inplace=True)</span>

<span class="c1"># # Resample ECG per Menit dan Hitung Fitur-fitur</span>
<span class="c1"># df_ecg_resampled = df_ecg.resample(&#39;1T&#39;).agg({</span>
<span class="c1">#     &#39;ecg_lead1_mV&#39;: [&#39;mean&#39;, &#39;std&#39;, &#39;max&#39;, &#39;min&#39;],</span>
<span class="c1">#     &#39;ecg_lead2_mV&#39;: [&#39;mean&#39;, &#39;std&#39;, &#39;max&#39;, &#39;min&#39;]</span>
<span class="c1"># })</span>

<span class="c1"># # Flatten MultiIndex columns</span>
<span class="c1"># df_ecg_resampled.columns = [&#39;_&#39;.join(col).strip() for col in df_ecg_resampled.columns.values]</span>
<span class="c1"># df_ecg_resampled.reset_index(inplace=True)</span>
<span class="c1"># df_ecg_resampled[&#39;time_s&#39;] = df_ecg_resampled[&#39;time_s_td&#39;].dt.total_seconds()</span>
<span class="c1"># df_ecg_resampled.drop(&#39;time_s_td&#39;, axis=1, inplace=True)</span>

<span class="c1"># print(&quot;\nDataFrame ECG setelah Resampling Per Menit:&quot;)</span>
<span class="c1"># print(df_ecg_resampled.head())</span>
<span class="c1"># print(df_ecg_resampled.dtypes)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-understanding">
<h1>Data Understanding<a class="headerlink" href="#data-understanding" title="Link to this heading">#</a></h1>
<p>Berdasarkan dataset seharusnya :</p>
<ul class="simple">
<li><p>Durasi Rekaman: 20 jam per individu.</p></li>
<li><p>Sampling Rate: 250 sampel per detik (Hz).</p></li>
<li><p>Resolusi: 12-bit pada rentang ±10 milivolt.</p></li>
<li><p>Sinyal: Dua saluran EKG (ecg_lead1 dan ecg_lead2).</p></li>
<li><p>Bandwidth Perekaman: 0,1 Hz hingga 40 Hz.</p></li>
<li><p>Anotasi: File anotasi (.ecg) disiapkan menggunakan detektor otomatis dan belum dikoreksi secara manual.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> <span class="c1"># type: ignore</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> <span class="c1"># type: ignore</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_Mulai docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_main</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;chf15_ecg_combined_features_per_minute.csv&#39;</span><span class="p">)</span>

<span class="n">df_main</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ecg_lead1_mV_mean</th>
      <th>ecg_lead1_mV_std</th>
      <th>ecg_lead1_mV_max</th>
      <th>ecg_lead1_mV_min</th>
      <th>ecg_lead2_mV_mean</th>
      <th>ecg_lead2_mV_std</th>
      <th>ecg_lead2_mV_max</th>
      <th>ecg_lead2_mV_min</th>
      <th>time_s</th>
      <th>heart_rate_bpm</th>
      <th>RR_interval_s</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.357024</td>
      <td>0.374176</td>
      <td>1.235</td>
      <td>-1.920</td>
      <td>-0.185898</td>
      <td>0.867105</td>
      <td>1.300</td>
      <td>-3.120</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.331103</td>
      <td>0.391446</td>
      <td>1.110</td>
      <td>-2.530</td>
      <td>-0.204354</td>
      <td>0.830805</td>
      <td>1.150</td>
      <td>-2.970</td>
      <td>60.0</td>
      <td>75.333167</td>
      <td>0.796684</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.361755</td>
      <td>0.414529</td>
      <td>1.200</td>
      <td>-2.625</td>
      <td>-0.237613</td>
      <td>0.845752</td>
      <td>1.630</td>
      <td>-3.195</td>
      <td>120.0</td>
      <td>75.004203</td>
      <td>0.800160</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.333184</td>
      <td>0.330049</td>
      <td>0.635</td>
      <td>-1.830</td>
      <td>-0.188325</td>
      <td>0.741128</td>
      <td>0.910</td>
      <td>-2.625</td>
      <td>180.0</td>
      <td>76.332129</td>
      <td>0.786421</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.362135</td>
      <td>0.471481</td>
      <td>1.355</td>
      <td>-2.750</td>
      <td>-0.241028</td>
      <td>0.772336</td>
      <td>1.260</td>
      <td>-2.970</td>
      <td>240.0</td>
      <td>78.457543</td>
      <td>0.764861</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1195</th>
      <td>-0.278098</td>
      <td>0.939354</td>
      <td>2.835</td>
      <td>-4.305</td>
      <td>-0.134612</td>
      <td>0.864002</td>
      <td>1.305</td>
      <td>-3.170</td>
      <td>71700.0</td>
      <td>77.397910</td>
      <td>0.775429</td>
    </tr>
    <tr>
      <th>1196</th>
      <td>-0.311699</td>
      <td>0.686759</td>
      <td>2.310</td>
      <td>-3.115</td>
      <td>-0.167784</td>
      <td>0.889335</td>
      <td>1.545</td>
      <td>-3.285</td>
      <td>71760.0</td>
      <td>78.132114</td>
      <td>0.768557</td>
    </tr>
    <tr>
      <th>1197</th>
      <td>-0.302458</td>
      <td>0.539964</td>
      <td>1.540</td>
      <td>-2.765</td>
      <td>-0.145407</td>
      <td>0.896181</td>
      <td>1.445</td>
      <td>-3.075</td>
      <td>71820.0</td>
      <td>78.069905</td>
      <td>0.769077</td>
    </tr>
    <tr>
      <th>1198</th>
      <td>-0.290781</td>
      <td>0.959819</td>
      <td>2.490</td>
      <td>-4.655</td>
      <td>-0.156567</td>
      <td>1.036525</td>
      <td>1.945</td>
      <td>-3.720</td>
      <td>71880.0</td>
      <td>76.836856</td>
      <td>0.781316</td>
    </tr>
    <tr>
      <th>1199</th>
      <td>-0.286798</td>
      <td>0.658703</td>
      <td>2.220</td>
      <td>-3.050</td>
      <td>-0.145787</td>
      <td>1.108576</td>
      <td>1.530</td>
      <td>-3.365</td>
      <td>71940.0</td>
      <td>79.277483</td>
      <td>0.757150</td>
    </tr>
  </tbody>
</table>
<p>1200 rows × 11 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_main</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1200 entries, 0 to 1199
Data columns (total 11 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   ecg_lead1_mV_mean  1200 non-null   float64
 1   ecg_lead1_mV_std   1200 non-null   float64
 2   ecg_lead1_mV_max   1200 non-null   float64
 3   ecg_lead1_mV_min   1200 non-null   float64
 4   ecg_lead2_mV_mean  1200 non-null   float64
 5   ecg_lead2_mV_std   1200 non-null   float64
 6   ecg_lead2_mV_max   1200 non-null   float64
 7   ecg_lead2_mV_min   1200 non-null   float64
 8   time_s             1200 non-null   float64
 9   heart_rate_bpm     1199 non-null   float64
 10  RR_interval_s      1199 non-null   float64
dtypes: float64(11)
memory usage: 103.3 KB
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>ecg_lead1_mV_mean: Rata-rata amplitudo sinyal ECG Lead 1 dalam millivolt (mV).</p></li>
<li><p>ecg_lead1_mV_std: Standar deviasi amplitudo sinyal ECG Lead 1 dalam millivolt (mV).</p></li>
<li><p>ecg_lead1_mV_max: Nilai maksimum amplitudo sinyal ECG Lead 1 dalam millivolt (mV).</p></li>
<li><p>ecg_lead1_mV_min: Nilai minimum amplitudo sinyal ECG Lead 1 dalam millivolt (mV).</p></li>
<li><p>ecg_lead2_mV_mean: Rata-rata amplitudo sinyal ECG Lead 2 dalam millivolt (mV).</p></li>
<li><p>ecg_lead2_mV_std: Standar deviasi amplitudo sinyal ECG Lead 2 dalam millivolt (mV).</p></li>
<li><p>ecg_lead2_mV_max: Nilai maksimum amplitudo sinyal ECG Lead 2 dalam millivolt (mV).</p></li>
<li><p>ecg_lead2_mV_min: Nilai minimum amplitudo sinyal ECG Lead 2 dalam millivolt (mV).</p></li>
<li><p>time_s: Waktu dalam detik (s).</p></li>
<li><p>heart_rate_bpm: Denyut jantung dalam beats per minute (bpm), yaitu denyut per menit.</p></li>
<li><p>RR_interval_s: Interval RR dalam detik (s), yaitu waktu antara dua detak jantung berturut-turut.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_main</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ecg_lead1_mV_mean</th>
      <th>ecg_lead1_mV_std</th>
      <th>ecg_lead1_mV_max</th>
      <th>ecg_lead1_mV_min</th>
      <th>ecg_lead2_mV_mean</th>
      <th>ecg_lead2_mV_std</th>
      <th>ecg_lead2_mV_max</th>
      <th>ecg_lead2_mV_min</th>
      <th>time_s</th>
      <th>heart_rate_bpm</th>
      <th>RR_interval_s</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1200.000000</td>
      <td>1200.000000</td>
      <td>1200.000000</td>
      <td>1200.000000</td>
      <td>1200.000000</td>
      <td>1200.000000</td>
      <td>1200.000000</td>
      <td>1200.000000</td>
      <td>1200.000000</td>
      <td>1199.000000</td>
      <td>1199.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-0.312401</td>
      <td>0.553926</td>
      <td>1.733038</td>
      <td>-2.623233</td>
      <td>-0.188196</td>
      <td>0.902700</td>
      <td>1.542992</td>
      <td>-3.196658</td>
      <td>35970.000000</td>
      <td>78.132713</td>
      <td>0.774723</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.030318</td>
      <td>0.200923</td>
      <td>0.856648</td>
      <td>0.833376</td>
      <td>0.047489</td>
      <td>0.214324</td>
      <td>0.601456</td>
      <td>0.601139</td>
      <td>20793.268141</td>
      <td>6.869729</td>
      <td>0.071196</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-0.425712</td>
      <td>0.240549</td>
      <td>0.200000</td>
      <td>-6.430000</td>
      <td>-0.413539</td>
      <td>0.412150</td>
      <td>0.380000</td>
      <td>-5.110000</td>
      <td>0.000000</td>
      <td>60.982177</td>
      <td>0.635116</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.332535</td>
      <td>0.411897</td>
      <td>1.100000</td>
      <td>-3.077500</td>
      <td>-0.219199</td>
      <td>0.756119</td>
      <td>1.145000</td>
      <td>-3.611250</td>
      <td>17985.000000</td>
      <td>73.574994</td>
      <td>0.718747</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-0.311009</td>
      <td>0.526781</td>
      <td>1.682500</td>
      <td>-2.475000</td>
      <td>-0.186226</td>
      <td>0.915844</td>
      <td>1.530000</td>
      <td>-3.325000</td>
      <td>35970.000000</td>
      <td>78.757760</td>
      <td>0.762532</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>-0.291774</td>
      <td>0.627959</td>
      <td>2.255000</td>
      <td>-2.015000</td>
      <td>-0.158470</td>
      <td>1.082922</td>
      <td>1.850000</td>
      <td>-2.848750</td>
      <td>53955.000000</td>
      <td>83.520621</td>
      <td>0.815622</td>
    </tr>
    <tr>
      <th>max</th>
      <td>-0.188147</td>
      <td>1.854134</td>
      <td>6.265000</td>
      <td>-1.065000</td>
      <td>0.103195</td>
      <td>1.481602</td>
      <td>4.305000</td>
      <td>-1.815000</td>
      <td>71940.000000</td>
      <td>98.022908</td>
      <td>0.984000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sampling Rate Awal: Sinyal ECG awalnya disampling pada 250 Hz, yang berarti terdapat 250 sampel per detik.
Resampling ke Per Detik: Untuk ekstraksi fitur per detik, data ECG diresample dari 250 sampel per detik menjadi 1 sampel per detik dengan menghitung statistik seperti mean, std, max, dan min untuk setiap interval detik.</p>
<p>Durasi Rekaman: Rekaman berdurasi sekitar 20 jam. Dalam menit, ini setara dengan 20 × 360 = 1200 menit.
Jumlah Baris: Dengan resampling per detik, jumlah time akhir pada dataframe 72.000 detik dengan step 60 (per menit), yang sesuai dengan jumlah detik dalam 20 jam (71.974 adalah nilai mendekati karena kemungkinan pengurangan sedikit detik di awal atau akhir rekaman).</p>
<ul class="simple">
<li><p>Mean (Rata-rata)
Deskripsi Sentral: Memberikan informasi tentang nilai rata-rata sinyal ECG dalam interval detik tertentu.
Stabilitas Sinyal: Memungkinkan deteksi perubahan umum dalam tingkat sinyal.</p></li>
<li><p>Standard Deviation (Std)
Variabilitas: Mengukur seberapa bervariasinya sinyal ECG dalam interval detik, yang dapat menunjukkan fluktuasi atau irregularitas.
Deteksi Anomali: Variabilitas yang tinggi dapat menunjukkan adanya ketidakteraturan yang mungkin terkait dengan kondisi kesehatan.</p></li>
<li><p>Max (Nilai Maksimum) dan Min (Nilai Minimum)
Rentang Dinamis: Menyediakan informasi tentang rentang nilai sinyal ECG, yang dapat membantu dalam mendeteksi puncak (peak) dan lembah (trough) yang mungkin terkait dengan kompleks QRS, gelombang P, atau T.
Deteksi Puncak dan Lembah: Memudahkan identifikasi fitur morfologis penting dalam sinyal ECG.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot ECG Lead 1 dan Heart Rate terhadap waktu</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;time_s&#39;</span><span class="p">],</span> <span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;ecg_lead1_mV_mean&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ECG Lead 1 Mean&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ECG Lead 1 Mean over Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ECG Lead 1 Mean (mV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;time_s&#39;</span><span class="p">],</span> <span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;ecg_lead2_mV_mean&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ECG Lead 2 Mean&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ECG Lead 2 Mean over Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;ECG Lead 2 Mean (mV)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;time_s&#39;</span><span class="p">],</span> <span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;heart_rate_bpm&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Heart Rate (bpm)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Heart Rate over Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Heart Rate (bpm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dca1f70aeceaf13f425df7d16c25dfbd48781898cc93a5e7f9c28e34c37cd4db.png" src="_images/dca1f70aeceaf13f425df7d16c25dfbd48781898cc93a5e7f9c28e34c37cd4db.png" />
</div>
</div>
<section id="kualitas-data">
<h2>Kualitas Data<a class="headerlink" href="#kualitas-data" title="Link to this heading">#</a></h2>
<section id="distribusi-data">
<h3>Distribusi data<a class="headerlink" href="#distribusi-data" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Menggunakan histrogram untuk melihat distribusi fitur</span>
<span class="n">df_main</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d23a824bac4602dd074a3b0c2403c328c5e3cd63da16c5ba048168011fa07fb0.png" src="_images/d23a824bac4602dd074a3b0c2403c328c5e3cd63da16c5ba048168011fa07fb0.png" />
</div>
</div>
<p>dari grafik sepertinya tidak ada data yang terlalu aneh distribusinya</p>
</section>
<section id="missing-value">
<h3>Missing Value<a class="headerlink" href="#missing-value" title="Link to this heading">#</a></h3>
<p>Deteksi missing value</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df_main</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">df_main</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;time_s&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_main</span> <span class="o">=</span> <span class="n">df_main</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span> <span class="c1"># type: ignore</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df_main</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Visualisasi Missing Values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ecg_lead1_mV_mean    0
ecg_lead1_mV_std     0
ecg_lead1_mV_max     0
ecg_lead1_mV_min     0
ecg_lead2_mV_mean    0
ecg_lead2_mV_std     0
ecg_lead2_mV_max     0
ecg_lead2_mV_min     0
time_s               0
heart_rate_bpm       1
RR_interval_s        1
dtype: int64
</pre></div>
</div>
<img alt="_images/2dace9a8356cdd90e573b87a95c85412fec09a6f66b1d65dfee682343f5a19a9.png" src="_images/2dace9a8356cdd90e573b87a95c85412fec09a6f66b1d65dfee682343f5a19a9.png" />
</div>
</div>
</section>
<section id="korekasi-fitur">
<h3>Korekasi fitur<a class="headerlink" href="#korekasi-fitur" title="Link to this heading">#</a></h3>
<p>pada awal analisis korelasi antar fitur disini menujukkan 1 fitur yitu RR_interval yang punya korelasi terbalik yang tinggi terhadap HR(heart rate)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">df_main</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Menampilkan heatmap korelasi</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriks Korelasi Fitur&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7d3c04f663523cd6f84809fa0e46fa536267d2944c08358ee4693dcce0dcf195.png" src="_images/7d3c04f663523cd6f84809fa0e46fa536267d2944c08358ee4693dcce0dcf195.png" />
</div>
</div>
</section>
<section id="outlier">
<h3>Outlier<a class="headerlink" href="#outlier" title="Link to this heading">#</a></h3>
<p>Disini saya akan mencoba mendeteksi outlier dengan LOF score dari sklearn, dimana LOF score -1 akan dianggap outlier</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span> <span class="c1"># type: ignore</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">lof</span> <span class="o">=</span> <span class="n">LocalOutlierFactor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">,</span> <span class="n">contamination</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>  <span class="c1"># contamination adalah proporsi outlier</span>

<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lof</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df_main</span><span class="p">)</span>
<span class="n">lof_scores</span> <span class="o">=</span> <span class="n">lof</span><span class="o">.</span><span class="n">negative_outlier_factor_</span>

<span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;LOF_Score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lof_scores</span>
<span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ahmad\AppData\Local\Temp\ipykernel_17784\3334004296.py:8: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_main[&#39;LOF_Score&#39;] = lof_scores
C:\Users\ahmad\AppData\Local\Temp\ipykernel_17784\3334004296.py:9: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_main[&#39;Outlier&#39;] = y_pred
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outliers</span> <span class="o">=</span> <span class="n">df_main</span><span class="p">[</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outliers</span><span class="p">)</span>

<span class="c1"># Visualisasi distribusi skor LOF</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;LOF_Score&#39;</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribusi Skor LOF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;LOF Score&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frekuensi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         ecg_lead1_mV_mean  ecg_lead1_mV_std  ecg_lead1_mV_max  \
time_s                                                           
6660.0           -0.342613          0.522799             1.660   
8400.0           -0.375052          0.858894             1.705   
9720.0           -0.339717          1.326414             5.000   
12300.0          -0.347519          1.255000             6.265   
14640.0          -0.315883          1.639101             4.640   
20520.0          -0.316834          1.250429             2.890   
21660.0          -0.320813          0.818994             2.720   
24300.0          -0.285981          0.877117             4.960   
24840.0          -0.289151          0.628652             1.840   
25980.0          -0.328209          1.007793             3.425   
26160.0          -0.414654          1.380965             5.550   
26460.0          -0.318956          1.662369             5.810   
30420.0          -0.289111          0.787262             2.755   
36180.0          -0.367159          1.476154             2.715   
36660.0          -0.351298          0.472723             1.225   
37380.0          -0.249572          1.601390             5.875   
37440.0          -0.422884          1.854134             4.495   
37560.0          -0.296115          0.859524             2.460   
38040.0          -0.317033          0.558936             1.960   
38100.0          -0.309745          0.430384             1.305   
38160.0          -0.328344          0.577181             2.185   
41400.0          -0.343850          0.276591             0.465   
42900.0          -0.303971          0.939412             2.085   
43200.0          -0.289489          1.123420             4.260   
43800.0          -0.298774          0.885719             2.000   
43860.0          -0.289200          1.311877             4.505   
44820.0          -0.390134          1.464156             4.060   
44880.0          -0.230134          0.856747             3.320   
45000.0          -0.259516          0.932991             3.465   
45540.0          -0.322979          1.716454             5.305   
47160.0          -0.312630          1.121124             4.225   
47400.0          -0.334647          1.246930             3.485   
53400.0          -0.312795          0.655575             2.955   
55560.0          -0.290606          0.981563             4.005   
55680.0          -0.298185          1.072963             3.730   
56640.0          -0.308372          0.750085             2.880   
57720.0          -0.266044          0.859488             3.305   
58740.0          -0.310388          0.639549             2.335   
59640.0          -0.297187          0.474040             2.105   
62640.0          -0.259355          0.627963             2.705   
64380.0          -0.288922          0.796525             2.760   
65040.0          -0.303001          0.572836             1.695   
67980.0          -0.293901          0.360602             0.970   
68760.0          -0.264716          0.425482             1.670   
68820.0          -0.304222          0.642890             2.720   
68880.0          -0.290030          0.545574             2.035   
68940.0          -0.275382          0.573939             2.010   
69000.0          -0.296531          0.567535             2.045   
69060.0          -0.328527          0.555471             1.895   
69120.0          -0.270756          0.559194             1.945   
69180.0          -0.277601          0.950237             2.700   
69240.0          -0.300639          0.614873             2.170   
69300.0          -0.264909          0.598807             2.085   
69840.0          -0.295769          0.501822             1.370   
70260.0          -0.330618          1.102791             3.265   
71100.0          -0.288905          0.554388             1.765   
71160.0          -0.264483          0.562422             2.375   
71340.0          -0.309333          0.680783             2.505   
71400.0          -0.301869          0.980285             3.570   
71700.0          -0.278098          0.939354             2.835   

         ecg_lead1_mV_min  ecg_lead2_mV_mean  ecg_lead2_mV_std  \
time_s                                                           
6660.0             -4.170          -0.246822          0.751812   
8400.0             -4.335          -0.200750          0.848197   
9720.0             -4.685          -0.246509          0.989601   
12300.0            -4.155          -0.238124          1.071666   
14640.0            -5.950          -0.217184          1.441284   
20520.0            -6.280          -0.145546          1.212790   
21660.0            -4.400          -0.210962          1.139694   
24300.0            -2.895          -0.224252          0.916807   
24840.0            -3.560          -0.172110          1.052038   
25980.0            -4.645          -0.186272          1.085440   
26160.0            -3.855          -0.227526          1.481602   
26460.0            -4.000          -0.205683          1.291629   
30420.0            -3.385          -0.194273          1.322007   
36180.0            -6.430          -0.174618          1.144438   
36660.0            -2.210          -0.207308          1.039551   
37380.0            -4.620          -0.161505          1.255467   
37440.0            -5.615          -0.223603          1.089558   
37560.0            -5.620          -0.184156          1.243537   
38040.0            -3.010          -0.213304          1.219528   
38100.0            -2.245          -0.118887          1.112375   
38160.0            -3.305          -0.133297          1.235716   
41400.0            -1.725          -0.193557          0.922239   
42900.0            -6.270          -0.259253          1.063247   
43200.0            -3.640          -0.113612          1.015045   
43800.0            -3.715          -0.134992          1.005030   
43860.0            -4.695          -0.189918          1.341481   
44820.0            -4.815          -0.149223          1.079101   
44880.0            -2.380          -0.221384          1.135782   
45000.0            -3.410          -0.225034          1.297977   
45540.0            -4.705          -0.171869          1.179750   
47160.0            -4.095          -0.196401          1.232741   
47400.0            -5.170          -0.193250          0.870674   
53400.0            -2.825          -0.139722          1.085474   
55560.0            -3.480           0.103195          0.940645   
55680.0            -3.785          -0.209711          0.989040   
56640.0            -3.120          -0.155454          1.086251   
57720.0            -3.330          -0.244170          1.133935   
58740.0            -3.430          -0.141078          0.584460   
59640.0            -2.775          -0.065337          0.587774   
62640.0            -2.995          -0.242157          1.011790   
64380.0            -3.960          -0.253697          0.847580   
65040.0            -3.345          -0.160119          0.610531   
67980.0            -2.765          -0.181610          0.455952   
68760.0            -2.055          -0.183406          0.560072   
68820.0            -2.480          -0.098822          1.054821   
68880.0            -2.500          -0.147726          1.019714   
68940.0            -2.305          -0.228997          1.043967   
69000.0            -2.450          -0.144833          1.020786   
69060.0            -2.425          -0.203326          1.018817   
69120.0            -2.390          -0.125636          1.033551   
69180.0            -5.030          -0.167531          0.982439   
69240.0            -3.910          -0.203292          0.975798   
69300.0            -3.920          -0.197412          0.752384   
69840.0            -3.700          -0.209859          0.656003   
70260.0            -5.140          -0.176309          0.857275   
71100.0            -3.530          -0.156911          0.600508   
71160.0            -3.315          -0.125944          0.675244   
71340.0            -3.075          -0.173075          0.932946   
71400.0            -4.010          -0.209080          0.866331   
71700.0            -4.305          -0.134612          0.864002   

         ecg_lead2_mV_max  ecg_lead2_mV_min  heart_rate_bpm  RR_interval_s  \
time_s                                                                       
6660.0              1.200            -2.955       70.599723       0.850028   
8400.0              3.230            -3.325       82.570867       0.727036   
9720.0              3.140            -3.420       86.009630       0.697721   
12300.0             2.630            -4.110       89.240645       0.672449   
14640.0             3.500            -4.240       84.498677       0.710143   
20520.0             3.495            -4.090       75.991062       0.789789   
21660.0             2.315            -3.670       93.157217       0.693163   
24300.0             1.615            -3.460       80.114733       0.749050   
24840.0             1.945            -4.645       77.712283       0.772410   
25980.0             2.460            -4.605       71.916728       0.834479   
26160.0             4.305            -3.875       83.269074       0.720723   
26460.0             3.175            -3.970       78.838854       0.761165   
30420.0             2.750            -4.105       70.747534       0.848394   
36180.0             3.060            -4.305       83.167903       0.721857   
36660.0             3.270            -3.715       85.119298       0.705163   
37380.0             3.815            -3.970       84.984002       0.706212   
37440.0             2.750            -4.105       86.287187       0.695721   
37560.0             3.095            -4.710       86.983938       0.690115   
38040.0             2.765            -3.870       91.941248       0.659736   
38100.0             2.335            -3.450       98.022908       0.635116   
38160.0             3.450            -4.150       89.718814       0.668944   
41400.0             2.510            -3.865       84.268550       0.712095   
42900.0             2.670            -4.745       89.194774       0.672800   
43200.0             2.360            -3.745       90.114547       0.665911   
43800.0             2.000            -3.655       91.799058       0.653739   
43860.0             3.385            -5.110       89.654231       0.669528   
44820.0             2.455            -3.900       87.680554       0.686115   
44880.0             2.085            -3.620       86.856834       0.691034   
45000.0             3.730            -4.155       87.841289       0.683364   
45540.0             2.725            -4.315       82.646289       0.726169   
47160.0             2.350            -4.005       78.211342       0.767392   
47400.0             1.550            -3.135       86.977594       0.689931   
53400.0             3.385            -3.450       71.189688       0.842889   
55560.0             2.650            -3.290       72.706407       0.825500   
55680.0             1.740            -4.215       72.471743       0.828111   
56640.0             3.725            -3.550       76.000375       0.789579   
57720.0             2.665            -3.590       70.907670       0.846254   
58740.0             0.750            -2.435       69.686394       0.861217   
59640.0             2.185            -2.630       70.338150       0.853829   
62640.0             2.975            -4.015       70.316649       0.853486   
64380.0             2.230            -3.130       64.464481       0.930937   
65040.0             1.540            -3.290       66.882442       0.897194   
67980.0             0.520            -1.960       60.982177       0.984000   
68760.0             1.005            -3.450       62.029700       0.967355   
68820.0             1.700            -3.405       63.524141       0.944825   
68880.0             1.340            -3.365       66.568014       0.902567   
68940.0             1.320            -3.480       63.114289       0.950921   
69000.0             1.345            -3.350       65.606956       0.914667   
69060.0             1.295            -3.390       64.925660       0.927000   
69120.0             1.320            -3.335       63.756383       0.941250   
69180.0             1.685            -3.460       65.021280       0.923200   
69240.0             1.355            -3.325       68.710762       0.874435   
69300.0             3.595            -3.210       67.347579       0.891045   
69840.0             0.860            -2.290       65.498042       0.916242   
70260.0             1.780            -3.290       66.214698       0.906424   
71100.0             0.760            -2.225       65.094436       0.921939   
71160.0             1.070            -2.495       66.027579       0.909273   
71340.0             2.145            -3.595       69.322748       0.865771   
71400.0             1.250            -3.300       70.739258       0.848686   
71700.0             1.305            -3.170       77.397910       0.775429   

         LOF_Score  Outlier  
time_s                       
6660.0   -1.425917       -1  
8400.0   -1.340482       -1  
9720.0   -1.396954       -1  
12300.0  -1.909515       -1  
14640.0  -1.449994       -1  
20520.0  -2.171910       -1  
21660.0  -2.472526       -1  
24300.0  -1.609924       -1  
24840.0  -1.411964       -1  
25980.0  -1.502843       -1  
26160.0  -1.797321       -1  
26460.0  -1.910650       -1  
30420.0  -1.394153       -1  
36180.0  -1.611104       -1  
36660.0  -1.366927       -1  
37380.0  -1.658944       -1  
37440.0  -1.397179       -1  
37560.0  -1.370142       -1  
38040.0  -1.721600       -1  
38100.0  -5.376656       -1  
38160.0  -1.414701       -1  
41400.0  -1.548577       -1  
42900.0  -1.625414       -1  
43200.0  -1.528214       -1  
43800.0  -1.695592       -1  
43860.0  -1.618540       -1  
44820.0  -1.327522       -1  
44880.0  -1.331764       -1  
45000.0  -1.437001       -1  
45540.0  -1.572885       -1  
47160.0  -1.340081       -1  
47400.0  -1.367886       -1  
53400.0  -1.504022       -1  
55560.0  -1.434753       -1  
55680.0  -1.340442       -1  
56640.0  -1.657314       -1  
57720.0  -1.430639       -1  
58740.0  -1.455128       -1  
59640.0  -1.429225       -1  
62640.0  -1.558023       -1  
64380.0  -2.024569       -1  
65040.0  -1.332581       -1  
67980.0  -1.605609       -1  
68760.0  -1.468079       -1  
68820.0  -2.024293       -1  
68880.0  -1.413066       -1  
68940.0  -1.642105       -1  
69000.0  -1.756241       -1  
69060.0  -1.706847       -1  
69120.0  -1.648897       -1  
69180.0  -2.047170       -1  
69240.0  -1.498031       -1  
69300.0  -2.040711       -1  
69840.0  -1.555861       -1  
70260.0  -2.100555       -1  
71100.0  -1.609798       -1  
71160.0  -1.343376       -1  
71340.0  -1.507494       -1  
71400.0  -1.572950       -1  
71700.0  -1.328511       -1  
</pre></div>
</div>
<img alt="_images/0ad2ea67a26751ea5b146f04bdc7608eb13068c26af88386c33ebd6c0c7fee65.png" src="_images/0ad2ea67a26751ea5b146f04bdc7608eb13068c26af88386c33ebd6c0c7fee65.png" />
</div>
</div>
<p>dan seperti yang terlihat ada beberapa data outlier dengan frekuensi sinyal sampai 700</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-prepocessing">
<h1>Data Prepocessing<a class="headerlink" href="#data-prepocessing" title="Link to this heading">#</a></h1>
<p>Saya ingin bekerja dengan HR dalam bentuk bilangan bulat karena memang biasanya diipakai begitu</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;heart_rate_bpm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;heart_rate_bpm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\ahmad\AppData\Local\Temp\ipykernel_17784\1173908904.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_main[&#39;heart_rate_bpm&#39;] = df_main[&#39;heart_rate_bpm&#39;].round().astype(int)
</pre></div>
</div>
</div>
</div>
<section id="mengatasi-outlier">
<h2>Mengatasi Outlier<a class="headerlink" href="#mengatasi-outlier" title="Link to this heading">#</a></h2>
<p>Untuk Outlier saya menggunakan interpolasi linier untuk mengganti data aneh</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_outliers</span> <span class="o">=</span> <span class="n">df_main</span><span class="p">[</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_inliers</span> <span class="o">=</span> <span class="n">df_main</span><span class="p">[</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah outlier: </span><span class="si">{</span><span class="n">df_outliers</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jumlah inlier: </span><span class="si">{</span><span class="n">df_inliers</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jumlah outlier: 60
Jumlah inlier: 1139
</pre></div>
</div>
</div>
</div>
<p>Interpolasi Linear</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_main</span> <span class="o">=</span> <span class="n">df_main</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">numerical_cols</span> <span class="o">=</span> <span class="n">df_main</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="s1">&#39;int64&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Kolom numerik untuk interpolasi:&quot;</span><span class="p">,</span> <span class="n">numerical_cols</span><span class="p">)</span>

<span class="n">df_interpolated</span> <span class="o">=</span> <span class="n">df_main</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_interpolated</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_interpolated</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">numerical_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">NA</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kolom numerik untuk interpolasi: [&#39;ecg_lead1_mV_mean&#39;, &#39;ecg_lead1_mV_std&#39;, &#39;ecg_lead1_mV_max&#39;, &#39;ecg_lead1_mV_min&#39;, &#39;ecg_lead2_mV_mean&#39;, &#39;ecg_lead2_mV_std&#39;, &#39;ecg_lead2_mV_max&#39;, &#39;ecg_lead2_mV_min&#39;, &#39;RR_interval_s&#39;, &#39;LOF_Score&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_interpolated</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_interpolated</span><span class="p">[</span><span class="n">numerical_cols</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="n">df_main</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">numerical_cols</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_interpolated</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">numerical_cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cols_to_plot</span> <span class="o">=</span> <span class="n">numerical_cols</span><span class="p">[::</span><span class="mi">3</span><span class="p">]</span> 

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols_to_plot</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    
    <span class="c1"># Plot sebelum interpolasi</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_outliers</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_outliers</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Outlier&#39;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_inliers</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_inliers</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Inlier&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sebelum Interpolasi - </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="c1"># Plot setelah interpolasi</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_main</span><span class="p">[</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_main</span><span class="p">[</span><span class="n">df_main</span><span class="p">[</span><span class="s1">&#39;Outlier&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">col</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Interpolasi&#39;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">df_inliers</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">df_inliers</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Inlier&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sesudah Interpolasi - </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cb7ef0fca42ee1a0d0e466eb8ebd5ad015dded24fec03bb58ae3672a118209be.png" src="_images/cb7ef0fca42ee1a0d0e466eb8ebd5ad015dded24fec03bb58ae3672a118209be.png" />
<img alt="_images/c3dca3fa16094f347413354f0c41d4de226ec18968320c7fb7b059e474c42435.png" src="_images/c3dca3fa16094f347413354f0c41d4de226ec18968320c7fb7b059e474c42435.png" />
<img alt="_images/ebc98910ea014f8175e4ed827766d6a4e7ea6ac650d608493fa821f96bab2db2.png" src="_images/ebc98910ea014f8175e4ed827766d6a4e7ea6ac650d608493fa821f96bab2db2.png" />
<img alt="_images/700c71906e32584bb168ae0c1bbcc5543c572ed6c8157bc3e3bee5bd3888f0a7.png" src="_images/700c71906e32584bb168ae0c1bbcc5543c572ed6c8157bc3e3bee5bd3888f0a7.png" />
</div>
</div>
</section>
<section id="seleksi-fitur">
<h2>Seleksi Fitur<a class="headerlink" href="#seleksi-fitur" title="Link to this heading">#</a></h2>
<p>Untuk seleksi fitur disini saya memanfaatkan korelasi matrix untuk mencari hubungan fitur lain dengan HR diatas 0.5 / -0.5</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_main</span> <span class="o">=</span> <span class="n">df_main</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;LOF_Score&#39;</span><span class="p">,</span> <span class="s1">&#39;Outlier&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">df_main</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Menampilkan heatmap korelasi</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corr_matrix</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.2f&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriks Korelasi Fitur&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/371a41f5189d880abf9657d156afbb6fe21e28c94d55015bc91233df8b178e59.png" src="_images/371a41f5189d880abf9657d156afbb6fe21e28c94d55015bc91233df8b178e59.png" />
</div>
</div>
<p>disini fitur yang saya pilih :</p>
<ul class="simple">
<li><p>RR_interval : meskipun korelasinya terbalik namun sangat kuat terhatap HR sebesar 0.99</p></li>
<li><p>signal ECG lead 2 max (tertingi) : mempunyai korelasi walaupun sedikit lemah</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_df</span> <span class="o">=</span> <span class="n">df_main</span><span class="p">[[</span><span class="s1">&#39;ecg_lead2_mV_max&#39;</span><span class="p">,</span><span class="s1">&#39;RR_interval_s&#39;</span><span class="p">,</span> <span class="s1">&#39;heart_rate_bpm&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<section id="menyiapkan-data-untuk-recursive-multi-step-forecasting">
<h3>Menyiapkan Data untuk Recursive Multi-step Forecasting<a class="headerlink" href="#menyiapkan-data-untuk-recursive-multi-step-forecasting" title="Link to this heading">#</a></h3>
<p>Pada recursive forecasting, kita perlu:</p>
<p>Membuat data lag untuk setiap kolom yang digunakan sebagai input.
Input model adalah beberapa langkah sebelumnya dari setiap fitur yang dipilih.
Target model adalah satu langkah ke depan yang ingin diprediksi, tetapi untuk prediksi langkah berikutnya kita akan menggunakan output sebelumnya.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_df</span> <span class="o">=</span> <span class="n">selected_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;time_s&#39;</span><span class="p">)</span>
<span class="n">selected_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ecg_lead2_mV_max</th>
      <th>RR_interval_s</th>
      <th>heart_rate_bpm</th>
    </tr>
    <tr>
      <th>time_s</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>60.0</th>
      <td>1.150</td>
      <td>0.796684</td>
      <td>75</td>
    </tr>
    <tr>
      <th>120.0</th>
      <td>1.630</td>
      <td>0.800160</td>
      <td>75</td>
    </tr>
    <tr>
      <th>180.0</th>
      <td>0.910</td>
      <td>0.786421</td>
      <td>76</td>
    </tr>
    <tr>
      <th>240.0</th>
      <td>1.260</td>
      <td>0.764861</td>
      <td>78</td>
    </tr>
    <tr>
      <th>300.0</th>
      <td>1.090</td>
      <td>0.763949</td>
      <td>79</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>71700.0</th>
      <td>1.275</td>
      <td>0.782518</td>
      <td>77</td>
    </tr>
    <tr>
      <th>71760.0</th>
      <td>1.545</td>
      <td>0.768557</td>
      <td>78</td>
    </tr>
    <tr>
      <th>71820.0</th>
      <td>1.445</td>
      <td>0.769077</td>
      <td>78</td>
    </tr>
    <tr>
      <th>71880.0</th>
      <td>1.945</td>
      <td>0.781316</td>
      <td>77</td>
    </tr>
    <tr>
      <th>71940.0</th>
      <td>1.530</td>
      <td>0.757150</td>
      <td>79</td>
    </tr>
  </tbody>
</table>
<p>1199 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;heart_rate_bpm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>int32
</pre></div>
</div>
</div>
</div>
</section>
<section id="lag-fitur">
<h3>Lag Fitur<a class="headerlink" href="#lag-fitur" title="Link to this heading">#</a></h3>
<p>Disini karena saya ingin prediksi 10 menit kedepan, saya membuat 10 lag fitur</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_lags</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">selected_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;RR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;RR_interval_s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>
    <span class="n">selected_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ECGL_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;ecg_lead2_mV_max&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>

<span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">selected_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;HR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;heart_rate_bpm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="n">lag</span><span class="p">)</span>

<span class="n">selected_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">selected_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ecg_lead2_mV_max</th>
      <th>RR_interval_s</th>
      <th>heart_rate_bpm</th>
      <th>RR_lag_1</th>
      <th>ECGL_lag_1</th>
      <th>RR_lag_2</th>
      <th>ECGL_lag_2</th>
      <th>RR_lag_3</th>
      <th>ECGL_lag_3</th>
      <th>RR_lag_4</th>
      <th>...</th>
      <th>HR_lag_1</th>
      <th>HR_lag_2</th>
      <th>HR_lag_3</th>
      <th>HR_lag_4</th>
      <th>HR_lag_5</th>
      <th>HR_lag_6</th>
      <th>HR_lag_7</th>
      <th>HR_lag_8</th>
      <th>HR_lag_9</th>
      <th>HR_lag_10</th>
    </tr>
    <tr>
      <th>time_s</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>660.0</th>
      <td>1.670</td>
      <td>0.784571</td>
      <td>76</td>
      <td>0.790507</td>
      <td>0.935</td>
      <td>0.777385</td>
      <td>0.775</td>
      <td>0.765231</td>
      <td>0.880</td>
      <td>0.759291</td>
      <td>...</td>
      <td>76.0</td>
      <td>77.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>76.0</td>
      <td>75.0</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>720.0</th>
      <td>1.305</td>
      <td>0.794240</td>
      <td>76</td>
      <td>0.784571</td>
      <td>1.670</td>
      <td>0.790507</td>
      <td>0.935</td>
      <td>0.777385</td>
      <td>0.775</td>
      <td>0.765231</td>
      <td>...</td>
      <td>76.0</td>
      <td>76.0</td>
      <td>77.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>76.0</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>780.0</th>
      <td>1.110</td>
      <td>0.780052</td>
      <td>77</td>
      <td>0.794240</td>
      <td>1.305</td>
      <td>0.784571</td>
      <td>1.670</td>
      <td>0.790507</td>
      <td>0.935</td>
      <td>0.777385</td>
      <td>...</td>
      <td>76.0</td>
      <td>76.0</td>
      <td>76.0</td>
      <td>77.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>76.0</td>
    </tr>
    <tr>
      <th>840.0</th>
      <td>1.445</td>
      <td>0.777128</td>
      <td>77</td>
      <td>0.780052</td>
      <td>1.110</td>
      <td>0.794240</td>
      <td>1.305</td>
      <td>0.784571</td>
      <td>1.670</td>
      <td>0.790507</td>
      <td>...</td>
      <td>77.0</td>
      <td>76.0</td>
      <td>76.0</td>
      <td>76.0</td>
      <td>77.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>900.0</th>
      <td>0.905</td>
      <td>0.778182</td>
      <td>77</td>
      <td>0.777128</td>
      <td>1.445</td>
      <td>0.780052</td>
      <td>1.110</td>
      <td>0.794240</td>
      <td>1.305</td>
      <td>0.784571</td>
      <td>...</td>
      <td>77.0</td>
      <td>77.0</td>
      <td>76.0</td>
      <td>76.0</td>
      <td>76.0</td>
      <td>77.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>71700.0</th>
      <td>1.275</td>
      <td>0.782518</td>
      <td>77</td>
      <td>0.796480</td>
      <td>1.005</td>
      <td>0.777195</td>
      <td>1.450</td>
      <td>0.806773</td>
      <td>1.255</td>
      <td>0.835778</td>
      <td>...</td>
      <td>75.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>72.0</td>
      <td>71.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>67.0</td>
      <td>66.0</td>
      <td>65.0</td>
    </tr>
    <tr>
      <th>71760.0</th>
      <td>1.545</td>
      <td>0.768557</td>
      <td>78</td>
      <td>0.782518</td>
      <td>1.275</td>
      <td>0.796480</td>
      <td>1.005</td>
      <td>0.777195</td>
      <td>1.450</td>
      <td>0.806773</td>
      <td>...</td>
      <td>77.0</td>
      <td>75.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>72.0</td>
      <td>71.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>67.0</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>71820.0</th>
      <td>1.445</td>
      <td>0.769077</td>
      <td>78</td>
      <td>0.768557</td>
      <td>1.545</td>
      <td>0.782518</td>
      <td>1.275</td>
      <td>0.796480</td>
      <td>1.005</td>
      <td>0.777195</td>
      <td>...</td>
      <td>78.0</td>
      <td>77.0</td>
      <td>75.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>72.0</td>
      <td>71.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>67.0</td>
    </tr>
    <tr>
      <th>71880.0</th>
      <td>1.945</td>
      <td>0.781316</td>
      <td>77</td>
      <td>0.769077</td>
      <td>1.445</td>
      <td>0.768557</td>
      <td>1.545</td>
      <td>0.782518</td>
      <td>1.275</td>
      <td>0.796480</td>
      <td>...</td>
      <td>78.0</td>
      <td>78.0</td>
      <td>77.0</td>
      <td>75.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>72.0</td>
      <td>71.0</td>
      <td>69.0</td>
      <td>67.0</td>
    </tr>
    <tr>
      <th>71940.0</th>
      <td>1.530</td>
      <td>0.757150</td>
      <td>79</td>
      <td>0.781316</td>
      <td>1.945</td>
      <td>0.769077</td>
      <td>1.445</td>
      <td>0.768557</td>
      <td>1.545</td>
      <td>0.782518</td>
      <td>...</td>
      <td>77.0</td>
      <td>78.0</td>
      <td>78.0</td>
      <td>77.0</td>
      <td>75.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>72.0</td>
      <td>71.0</td>
      <td>69.0</td>
    </tr>
  </tbody>
</table>
<p>1189 rows × 33 columns</p>
</div></div></div>
</div>
</section>
<section id="horizon-target">
<h3>Horizon / Target<a class="headerlink" href="#horizon-target" title="Link to this heading">#</a></h3>
<p>Dalam kasus ini, kita ingin memprediksi Heart Rate BPM (HR) 10 menit ke depan, tetapi tetap melibatkan fitur lain seperti RR Interval dan ECG Lead2.</p>
<p>HR_future disini akan digunakan dalam model rekursif multistep forecasting sebagai kolom tujuan 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;HR_future_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;heart_rate_bpm&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;RR_future_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;RR_interval_s&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;ECGL_future_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;ecg_lead2_mV_max&#39;</span><span class="p">]</span>

<span class="n">selected_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># feature_cols = [&#39;HR_lag_0&#39;] + \</span>
<span class="c1">#                 [f&#39;RR_lag_{lag}&#39; for lag in range(1, 11)] + \</span>
<span class="c1">#                 [f&#39;ECGL_lag_{lag}&#39; for lag in range(1, 11)] + \</span>
<span class="c1">#                 [f&#39;HR_lag_{lag}&#39; for lag in range(1, 11)]</span>

<span class="c1"># # Memisahkan fitur dan target</span>
<span class="c1"># X = selected_df[feature_cols]</span>
<span class="c1"># y = selected_df[&#39;HR_future_1&#39;]</span>

<span class="n">feature_cols_hr</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;HR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>
<span class="n">feature_cols_rr</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;RR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>
<span class="n">feature_cols_ecg</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ECGL_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>

<span class="n">feature_cols</span> <span class="o">=</span> <span class="n">feature_cols_rr</span> <span class="o">+</span> <span class="n">feature_cols_ecg</span> <span class="o">+</span> <span class="n">feature_cols_hr</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="n">feature_cols</span><span class="p">]</span>

<span class="n">y_hr</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;HR_future_1&#39;</span><span class="p">]</span>
<span class="n">y_rr</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;RR_future_1&#39;</span><span class="p">]</span>    
<span class="n">y_ecg</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="s1">&#39;ECGL_future_1&#39;</span><span class="p">]</span>   
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ecg_lead2_mV_max</th>
      <th>RR_interval_s</th>
      <th>heart_rate_bpm</th>
      <th>RR_lag_1</th>
      <th>ECGL_lag_1</th>
      <th>RR_lag_2</th>
      <th>ECGL_lag_2</th>
      <th>RR_lag_3</th>
      <th>ECGL_lag_3</th>
      <th>RR_lag_4</th>
      <th>...</th>
      <th>HR_lag_4</th>
      <th>HR_lag_5</th>
      <th>HR_lag_6</th>
      <th>HR_lag_7</th>
      <th>HR_lag_8</th>
      <th>HR_lag_9</th>
      <th>HR_lag_10</th>
      <th>HR_future_1</th>
      <th>RR_future_1</th>
      <th>ECGL_future_1</th>
    </tr>
    <tr>
      <th>time_s</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>660.0</th>
      <td>1.670</td>
      <td>0.784571</td>
      <td>76</td>
      <td>0.790507</td>
      <td>0.935</td>
      <td>0.777385</td>
      <td>0.775</td>
      <td>0.765231</td>
      <td>0.880</td>
      <td>0.759291</td>
      <td>...</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>76.0</td>
      <td>75.0</td>
      <td>75.0</td>
      <td>76.0</td>
      <td>0.794240</td>
      <td>1.670</td>
    </tr>
    <tr>
      <th>720.0</th>
      <td>1.305</td>
      <td>0.794240</td>
      <td>76</td>
      <td>0.784571</td>
      <td>1.670</td>
      <td>0.790507</td>
      <td>0.935</td>
      <td>0.777385</td>
      <td>0.775</td>
      <td>0.765231</td>
      <td>...</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>76.0</td>
      <td>75.0</td>
      <td>77.0</td>
      <td>0.780052</td>
      <td>1.305</td>
    </tr>
    <tr>
      <th>780.0</th>
      <td>1.110</td>
      <td>0.780052</td>
      <td>77</td>
      <td>0.794240</td>
      <td>1.305</td>
      <td>0.784571</td>
      <td>1.670</td>
      <td>0.790507</td>
      <td>0.935</td>
      <td>0.777385</td>
      <td>...</td>
      <td>77.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>76.0</td>
      <td>77.0</td>
      <td>0.777128</td>
      <td>1.110</td>
    </tr>
    <tr>
      <th>840.0</th>
      <td>1.445</td>
      <td>0.777128</td>
      <td>77</td>
      <td>0.780052</td>
      <td>1.110</td>
      <td>0.794240</td>
      <td>1.305</td>
      <td>0.784571</td>
      <td>1.670</td>
      <td>0.790507</td>
      <td>...</td>
      <td>76.0</td>
      <td>77.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>77.0</td>
      <td>0.778182</td>
      <td>1.445</td>
    </tr>
    <tr>
      <th>900.0</th>
      <td>0.905</td>
      <td>0.778182</td>
      <td>77</td>
      <td>0.777128</td>
      <td>1.445</td>
      <td>0.780052</td>
      <td>1.110</td>
      <td>0.794240</td>
      <td>1.305</td>
      <td>0.784571</td>
      <td>...</td>
      <td>76.0</td>
      <td>76.0</td>
      <td>77.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>78.0</td>
      <td>79.0</td>
      <td>77.0</td>
      <td>0.781632</td>
      <td>0.905</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>71640.0</th>
      <td>1.005</td>
      <td>0.796480</td>
      <td>75</td>
      <td>0.777195</td>
      <td>1.450</td>
      <td>0.806773</td>
      <td>1.255</td>
      <td>0.835778</td>
      <td>1.175</td>
      <td>0.854638</td>
      <td>...</td>
      <td>71.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>67.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>65.0</td>
      <td>77.0</td>
      <td>0.782518</td>
      <td>1.005</td>
    </tr>
    <tr>
      <th>71700.0</th>
      <td>1.275</td>
      <td>0.782518</td>
      <td>77</td>
      <td>0.796480</td>
      <td>1.005</td>
      <td>0.777195</td>
      <td>1.450</td>
      <td>0.806773</td>
      <td>1.255</td>
      <td>0.835778</td>
      <td>...</td>
      <td>72.0</td>
      <td>71.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>67.0</td>
      <td>66.0</td>
      <td>65.0</td>
      <td>78.0</td>
      <td>0.768557</td>
      <td>1.275</td>
    </tr>
    <tr>
      <th>71760.0</th>
      <td>1.545</td>
      <td>0.768557</td>
      <td>78</td>
      <td>0.782518</td>
      <td>1.275</td>
      <td>0.796480</td>
      <td>1.005</td>
      <td>0.777195</td>
      <td>1.450</td>
      <td>0.806773</td>
      <td>...</td>
      <td>74.0</td>
      <td>72.0</td>
      <td>71.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>67.0</td>
      <td>66.0</td>
      <td>78.0</td>
      <td>0.769077</td>
      <td>1.545</td>
    </tr>
    <tr>
      <th>71820.0</th>
      <td>1.445</td>
      <td>0.769077</td>
      <td>78</td>
      <td>0.768557</td>
      <td>1.545</td>
      <td>0.782518</td>
      <td>1.275</td>
      <td>0.796480</td>
      <td>1.005</td>
      <td>0.777195</td>
      <td>...</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>72.0</td>
      <td>71.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>0.781316</td>
      <td>1.445</td>
    </tr>
    <tr>
      <th>71880.0</th>
      <td>1.945</td>
      <td>0.781316</td>
      <td>77</td>
      <td>0.769077</td>
      <td>1.445</td>
      <td>0.768557</td>
      <td>1.545</td>
      <td>0.782518</td>
      <td>1.275</td>
      <td>0.796480</td>
      <td>...</td>
      <td>75.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>72.0</td>
      <td>71.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>79.0</td>
      <td>0.757150</td>
      <td>1.945</td>
    </tr>
  </tbody>
</table>
<p>1188 rows × 36 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_lags</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">selected_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;HR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;HR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">selected_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;HR_future_1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">selected_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;HR_future_1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="membagi-data-train-dan-test">
<h3>Membagi data train dan test<a class="headerlink" href="#membagi-data-train-dan-test" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">TimeSeriesSplit</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tentukan proporsi pembagian</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">split_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">selected_df</span><span class="p">)</span> <span class="o">*</span> <span class="n">train_size</span><span class="p">)</span>

<span class="c1"># Bagi data</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_index</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_index</span><span class="p">:]</span>
<span class="n">y_train_hr</span> <span class="o">=</span> <span class="n">y_hr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_index</span><span class="p">]</span>
<span class="n">y_test_hr</span> <span class="o">=</span> <span class="n">y_hr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_index</span><span class="p">:]</span>
<span class="n">y_train_rr</span> <span class="o">=</span> <span class="n">y_rr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_index</span><span class="p">]</span>
<span class="n">y_test_rr</span> <span class="o">=</span> <span class="n">y_rr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_index</span><span class="p">:]</span>
<span class="n">y_train_ecg</span> <span class="o">=</span> <span class="n">y_ecg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">split_index</span><span class="p">]</span>
<span class="n">y_test_ecg</span> <span class="o">=</span> <span class="n">y_ecg</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">split_index</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inisialisasi scaler tunggal untuk semua fitur</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="c1"># Transformasi data</span>
<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define feature indices for HR, RR, and ECGL</span>
<span class="n">feature_indices</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;hr&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">feature_cols</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;HR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)],</span>
    <span class="s1">&#39;rr&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">feature_cols</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;RR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)],</span>
    <span class="s1">&#39;ecg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">feature_cols</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ECGL_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelling">
<h1>Modelling<a class="headerlink" href="#modelling" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
</pre></div>
</div>
</div>
</div>
<p>Periksa dan Evaluasi Distribusi Data:</p>
<p>Analisis Distribusi Target (y):
Pastikan bahwa data target (HR_future_1) memiliki variasi yang memadai dan tidak terlalu terkonsentrasi di sekitar nilai tertentu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">import</span> <span class="nn">joblib</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mean_absolute_percentage_error_custom</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_true</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
    <span class="n">non_zero_indices</span> <span class="o">=</span> <span class="n">y_true</span> <span class="o">!=</span> <span class="mi">0</span>
    <span class="n">y_true</span> <span class="o">=</span> <span class="n">y_true</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">y_pred</span><span class="p">[</span><span class="n">non_zero_indices</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_true</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<section id="fungsi-rekursif-forcasts">
<h2>Fungsi Rekursif Forcasts<a class="headerlink" href="#fungsi-rekursif-forcasts" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Menggunakan scaler yang sama yang diterapkan pada data pelatihan.</p></li>
<li><p>Prediksi dan Pembaruan Lag:</p></li>
<li><p>Menghasilkan prediksi untuk langkah ke depan.</p></li>
<li><p>Menggeser nilai lag untuk RR_lag dan ECGL_lag, mempertahankan nilai terakhir.</p></li>
<li><p>Menggeser nilai lag untuk HR_lag dan memasukkan prediksi terbaru.</p></li>
<li><p>Pembulatan Prediksi: Mengonversi hasil prediksi menjadi bilangan bulat.</p></li>
</ul>
<p>Melakukan prediksi multi-step recursive untuk HR, RR_interval_s, dan ecg_lead2_mV_max.</p>
<p>Args:</p>
<ul class="simple">
<li><p>model_hr (sklearn estimator): Model Random Forest untuk HR.</p></li>
<li><p>model_rr (sklearn estimator): Model Random Forest untuk RR_interval_s.</p></li>
<li><p>model_ecg (sklearn estimator): Model Random Forest untuk ecg_lead2_mV_max.</p></li>
<li><p>scaler_hr (sklearn scaler): Scaler untuk fitur HR.</p></li>
<li><p>scaler_rr (sklearn scaler): Scaler untuk fitur RR.</p></li>
<li><p>scaler_ecg (sklearn scaler): Scaler untuk fitur ECGL.</p></li>
<li><p>X_input (numpy array): Data input awal (1D array).</p></li>
<li><p>steps (int): Jumlah langkah ke depan yang ingin diprediksi.</p></li>
<li><p>feature_cols (list): Daftar nama kolom fitur.</p></li>
<li><p>n_lags (int): Jumlah lag yang digunakan.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">recursive_forecast_multi</span><span class="p">(</span><span class="n">model_hr</span><span class="p">,</span> <span class="n">model_rr</span><span class="p">,</span> <span class="n">model_ecg</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">X_input</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="n">feature_cols</span><span class="p">,</span> <span class="n">n_lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">feature_indices</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="n">predictions_hr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">predictions_rr</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">predictions_ecg</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Pastikan X_input dalam bentuk 1D</span>
    <span class="k">if</span> <span class="n">X_input</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">X_input</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">X_input</span> <span class="o">=</span> <span class="n">X_input</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">X_input</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">X_input</span> <span class="o">=</span> <span class="n">X_input</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Buat DataFrame input</span>
    <span class="n">input_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">X_input</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">feature_cols</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="c1"># Skalasi seluruh fitur</span>
        <span class="n">input_scaled</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">input_df</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

        <span class="c1"># Pisahkan fitur HR, RR, dan ECGL berdasarkan indeks</span>
        <span class="n">features_hr</span> <span class="o">=</span> <span class="n">input_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;hr&#39;</span><span class="p">]]</span>
        <span class="n">features_rr</span> <span class="o">=</span> <span class="n">input_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;rr&#39;</span><span class="p">]]</span>
        <span class="n">features_ecg</span> <span class="o">=</span> <span class="n">input_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;ecg&#39;</span><span class="p">]]</span>

        <span class="c1"># Prediksi HR, RR, dan ECGL</span>
        <span class="n">pred_hr</span> <span class="o">=</span> <span class="n">model_hr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features_hr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pred_rr</span> <span class="o">=</span> <span class="n">model_rr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features_rr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pred_ecg</span> <span class="o">=</span> <span class="n">model_ecg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features_ecg</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Simpan prediksi</span>
        <span class="n">predictions_hr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred_hr</span><span class="p">)</span>
        <span class="n">predictions_rr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred_rr</span><span class="p">)</span>
        <span class="n">predictions_ecg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pred_ecg</span><span class="p">)</span>

        <span class="c1"># Pembaruan fitur lag</span>
        <span class="k">for</span> <span class="n">lag</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_lags</span><span class="p">):</span>
            <span class="n">input_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;HR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;HR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
            <span class="n">input_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;RR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;RR_lag_</span><span class="si">{</span><span class="n">lag</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
            <span class="n">input_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ECGL_lag_</span><span class="si">{</span><span class="n">lag</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ECGL_lag_</span><span class="si">{</span><span class="n">lag</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>

        <span class="c1"># Tambahkan prediksi terbaru</span>
        <span class="n">input_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;HR_lag_</span><span class="si">{</span><span class="n">n_lags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred_hr</span>
        <span class="n">input_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;RR_lag_</span><span class="si">{</span><span class="n">n_lags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred_rr</span>
        <span class="n">input_df</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ECGL_lag_</span><span class="si">{</span><span class="n">n_lags</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pred_ecg</span>

    <span class="c1"># Konversi prediksi ke bilangan bulat</span>
    <span class="n">predictions_hr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">predictions_hr</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">predictions_rr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">predictions_rr</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">predictions_ecg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">predictions_ecg</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">predictions_hr</span><span class="p">,</span> <span class="n">predictions_rr</span><span class="p">,</span> <span class="n">predictions_ecg</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="random-forest-regressor">
<h2>1. Random Forest Regressor<a class="headerlink" href="#random-forest-regressor" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_hr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">model_rr</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">model_ecg</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">model_hr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;hr&#39;</span><span class="p">]],</span> <span class="n">y_train_hr</span><span class="p">)</span>

<span class="n">model_rr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;rr&#39;</span><span class="p">]],</span> <span class="n">y_train_rr</span><span class="p">)</span>

<span class="n">model_ecg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;ecg&#39;</span><span class="p">]],</span> <span class="n">y_train_ecg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-24 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-24 {
  color: var(--sklearn-color-text);
}

#sk-container-id-24 pre {
  padding: 0;
}

#sk-container-id-24 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-24 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-24 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-24 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-24 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-24 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-24 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-24 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-24 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-24 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-24 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-24 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-24 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-24 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-24 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-24 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-24 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-24 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-24 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-24 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-24 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-24 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-24 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-24 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-24 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-24 div.sk-label label.sk-toggleable__label,
#sk-container-id-24 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-24 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-24 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-24 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-24 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-24 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-24 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-24 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-24 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-24 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-24 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-24 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-24 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-24" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestRegressor(random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-24" type="checkbox" checked><label for="sk-estimator-id-24" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;RandomForestRegressor<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.ensemble.RandomForestRegressor.html">?<span>Documentation for RandomForestRegressor</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>RandomForestRegressor(random_state=42)</pre></div> </div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_single_hr</span> <span class="o">=</span> <span class="n">model_hr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;hr&#39;</span><span class="p">]])</span>
<span class="n">y_pred_single_hr_rounded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y_pred_single_hr</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">mape_single_hr</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error_custom</span><span class="p">(</span><span class="n">y_test_hr</span><span class="p">,</span> <span class="n">y_pred_single_hr_rounded</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE (Single-step Prediction HR): </span><span class="si">{</span><span class="n">mape_single_hr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAPE (Single-step Prediction HR): 6.79%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_initial</span> <span class="o">=</span> <span class="n">X_test_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>  

<span class="n">steps</span> <span class="o">=</span> <span class="mi">30</span>  

<span class="n">predictions_hr</span><span class="p">,</span> <span class="n">predictions_rr</span><span class="p">,</span> <span class="n">predictions_ecg</span> <span class="o">=</span> <span class="n">recursive_forecast_multi</span><span class="p">(</span>
    <span class="n">model_hr</span><span class="o">=</span><span class="n">model_hr</span><span class="p">,</span>
    <span class="n">model_rr</span><span class="o">=</span><span class="n">model_rr</span><span class="p">,</span>
    <span class="n">model_ecg</span><span class="o">=</span><span class="n">model_ecg</span><span class="p">,</span>
    <span class="n">scaler</span><span class="o">=</span><span class="n">scaler</span><span class="p">,</span>
    <span class="n">X_input</span><span class="o">=</span><span class="n">X_initial</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
    <span class="n">feature_cols</span><span class="o">=</span><span class="n">feature_cols</span><span class="p">,</span>
    <span class="n">n_lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">feature_indices</span><span class="o">=</span><span class="n">feature_indices</span>
<span class="p">)</span>

<span class="n">actual_hr_recursive</span> <span class="o">=</span> <span class="n">y_test_hr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">steps</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">mape_recursive_hr</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error_custom</span><span class="p">(</span><span class="n">actual_hr_recursive</span><span class="p">,</span> <span class="n">predictions_hr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE (Recursive Forecasting HR): </span><span class="si">{</span><span class="n">mape_recursive_hr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAPE (Recursive Forecasting HR): 3.89%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Perbandingan Actual vs Predicted HR:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Langkah </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: Prediksi HR = </span><span class="si">{</span><span class="n">predictions_hr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> bpm, Aktual HR = </span><span class="si">{</span><span class="n">actual_hr_recursive</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> bpm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Perbandingan Actual vs Predicted HR:
Langkah 1: Prediksi HR = 72 bpm, Aktual HR = 71.0 bpm
Langkah 2: Prediksi HR = 71 bpm, Aktual HR = 73.0 bpm
Langkah 3: Prediksi HR = 71 bpm, Aktual HR = 72.0 bpm
Langkah 4: Prediksi HR = 71 bpm, Aktual HR = 71.0 bpm
Langkah 5: Prediksi HR = 71 bpm, Aktual HR = 75.0 bpm
Langkah 6: Prediksi HR = 71 bpm, Aktual HR = 73.0 bpm
Langkah 7: Prediksi HR = 70 bpm, Aktual HR = 73.0 bpm
Langkah 8: Prediksi HR = 73 bpm, Aktual HR = 75.0 bpm
Langkah 9: Prediksi HR = 71 bpm, Aktual HR = 74.0 bpm
Langkah 10: Prediksi HR = 71 bpm, Aktual HR = 74.0 bpm
Langkah 11: Prediksi HR = 72 bpm, Aktual HR = 72.0 bpm
Langkah 12: Prediksi HR = 71 bpm, Aktual HR = 71.0 bpm
Langkah 13: Prediksi HR = 71 bpm, Aktual HR = 70.0 bpm
Langkah 14: Prediksi HR = 71 bpm, Aktual HR = 70.0 bpm
Langkah 15: Prediksi HR = 71 bpm, Aktual HR = 69.0 bpm
Langkah 16: Prediksi HR = 73 bpm, Aktual HR = 69.0 bpm
Langkah 17: Prediksi HR = 73 bpm, Aktual HR = 69.0 bpm
Langkah 18: Prediksi HR = 74 bpm, Aktual HR = 70.0 bpm
Langkah 19: Prediksi HR = 72 bpm, Aktual HR = 68.0 bpm
Langkah 20: Prediksi HR = 71 bpm, Aktual HR = 70.0 bpm
Langkah 21: Prediksi HR = 71 bpm, Aktual HR = 70.0 bpm
Langkah 22: Prediksi HR = 71 bpm, Aktual HR = 70.0 bpm
Langkah 23: Prediksi HR = 71 bpm, Aktual HR = 70.0 bpm
Langkah 24: Prediksi HR = 73 bpm, Aktual HR = 70.0 bpm
Langkah 25: Prediksi HR = 77 bpm, Aktual HR = 69.0 bpm
Langkah 26: Prediksi HR = 77 bpm, Aktual HR = 69.0 bpm
Langkah 27: Prediksi HR = 77 bpm, Aktual HR = 70.0 bpm
Langkah 28: Prediksi HR = 75 bpm, Aktual HR = 69.0 bpm
Langkah 29: Prediksi HR = 71 bpm, Aktual HR = 69.0 bpm
Langkah 30: Prediksi HR = 71 bpm, Aktual HR = 68.0 bpm
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Membuat range untuk langkah prediksi</span>
<span class="n">steps_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Membuat plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps_range</span><span class="p">,</span> <span class="n">actual_hr_recursive</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual HR&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps_range</span><span class="p">,</span> <span class="n">predictions_hr</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted HR&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Langkah ke Depan&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Heart Rate (bpm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Perbandingan Actual vs Predicted Heart Rate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">steps_range</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5c59bddf5ad1e7803ad0de673c23055abb83c7129696a82d1411f97aa2e8e434.png" src="_images/5c59bddf5ad1e7803ad0de673c23055abb83c7129696a82d1411f97aa2e8e434.png" />
</div>
</div>
</section>
<section id="svr">
<h2>2. SVR<a class="headerlink" href="#svr" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_hr_svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">model_rr_svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">model_ecg_svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">model_hr_svr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;hr&#39;</span><span class="p">]],</span> <span class="n">y_train_hr</span><span class="p">)</span>

<span class="n">model_rr_svr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;rr&#39;</span><span class="p">]],</span> <span class="n">y_train_rr</span><span class="p">)</span>

<span class="n">model_ecg_svr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;ecg&#39;</span><span class="p">]],</span> <span class="n">y_train_ecg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-27 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-27 {
  color: var(--sklearn-color-text);
}

#sk-container-id-27 pre {
  padding: 0;
}

#sk-container-id-27 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-27 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-27 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-27 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-27 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-27 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-27 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-27 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-27 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-27 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-27 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-27 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-27 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-27 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-27 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-27 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-27 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-27 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-27 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-27 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-27 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-27 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-27 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-27 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-27 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-27 div.sk-label label.sk-toggleable__label,
#sk-container-id-27 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-27 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-27 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-27 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-27 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-27 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-27 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-27 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-27 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-27 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-27 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-27 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-27 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-27" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>SVR(C=50, epsilon=0.2, gamma=&#x27;auto&#x27;)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-27" type="checkbox" checked><label for="sk-estimator-id-27" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;SVR<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.svm.SVR.html">?<span>Documentation for SVR</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>SVR(C=50, epsilon=0.2, gamma=&#x27;auto&#x27;)</pre></div> </div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_initial</span> <span class="o">=</span> <span class="n">X_test_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>  

<span class="n">steps</span> <span class="o">=</span> <span class="mi">30</span>

<span class="n">predictions_hr_svr</span><span class="p">,</span> <span class="n">predictions_rr_svr</span><span class="p">,</span> <span class="n">predictions_ecg_svr</span> <span class="o">=</span> <span class="n">recursive_forecast_multi</span><span class="p">(</span>
    <span class="n">model_hr</span><span class="o">=</span><span class="n">model_hr_svr</span><span class="p">,</span>
    <span class="n">model_rr</span><span class="o">=</span><span class="n">model_rr_svr</span><span class="p">,</span>
    <span class="n">model_ecg</span><span class="o">=</span><span class="n">model_ecg_svr</span><span class="p">,</span>
    <span class="n">scaler</span><span class="o">=</span><span class="n">scaler</span><span class="p">,</span> 
    <span class="n">X_input</span><span class="o">=</span><span class="n">X_initial</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
    <span class="n">feature_cols</span><span class="o">=</span><span class="n">feature_cols</span><span class="p">,</span>
    <span class="n">n_lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">feature_indices</span><span class="o">=</span><span class="n">feature_indices</span>
<span class="p">)</span>

<span class="n">actual_hr_recursive</span> <span class="o">=</span> <span class="n">y_test_hr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">steps</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="n">mape_recursive_hr_svr</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">actual_hr_recursive</span><span class="p">,</span> <span class="n">predictions_hr_svr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE (Recursive Forecasting HR SVR): </span><span class="si">{</span><span class="n">mape_recursive_hr_svr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAPE (Recursive Forecasting HR SVR): 0.07%
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Perbandingan Actual vs Predicted HR (SVR):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Langkah </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: Prediksi HR = </span><span class="si">{</span><span class="n">predictions_hr_svr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> bpm, Aktual HR = </span><span class="si">{</span><span class="n">actual_hr_recursive</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> bpm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Perbandingan Actual vs Predicted HR (SVR):
Langkah 1: Prediksi HR = 70 bpm, Aktual HR = 71.0 bpm
Langkah 2: Prediksi HR = 70 bpm, Aktual HR = 73.0 bpm
Langkah 3: Prediksi HR = 70 bpm, Aktual HR = 72.0 bpm
Langkah 4: Prediksi HR = 69 bpm, Aktual HR = 71.0 bpm
Langkah 5: Prediksi HR = 69 bpm, Aktual HR = 75.0 bpm
Langkah 6: Prediksi HR = 67 bpm, Aktual HR = 73.0 bpm
Langkah 7: Prediksi HR = 66 bpm, Aktual HR = 73.0 bpm
Langkah 8: Prediksi HR = 62 bpm, Aktual HR = 75.0 bpm
Langkah 9: Prediksi HR = 55 bpm, Aktual HR = 74.0 bpm
Langkah 10: Prediksi HR = 44 bpm, Aktual HR = 74.0 bpm
Langkah 11: Prediksi HR = 71 bpm, Aktual HR = 72.0 bpm
Langkah 12: Prediksi HR = 71 bpm, Aktual HR = 71.0 bpm
Langkah 13: Prediksi HR = 71 bpm, Aktual HR = 70.0 bpm
Langkah 14: Prediksi HR = 69 bpm, Aktual HR = 70.0 bpm
Langkah 15: Prediksi HR = 68 bpm, Aktual HR = 69.0 bpm
Langkah 16: Prediksi HR = 69 bpm, Aktual HR = 69.0 bpm
Langkah 17: Prediksi HR = 67 bpm, Aktual HR = 69.0 bpm
Langkah 18: Prediksi HR = 63 bpm, Aktual HR = 70.0 bpm
Langkah 19: Prediksi HR = 59 bpm, Aktual HR = 68.0 bpm
Langkah 20: Prediksi HR = 53 bpm, Aktual HR = 70.0 bpm
Langkah 21: Prediksi HR = 72 bpm, Aktual HR = 70.0 bpm
Langkah 22: Prediksi HR = 72 bpm, Aktual HR = 70.0 bpm
Langkah 23: Prediksi HR = 71 bpm, Aktual HR = 70.0 bpm
Langkah 24: Prediksi HR = 69 bpm, Aktual HR = 70.0 bpm
Langkah 25: Prediksi HR = 68 bpm, Aktual HR = 69.0 bpm
Langkah 26: Prediksi HR = 70 bpm, Aktual HR = 69.0 bpm
Langkah 27: Prediksi HR = 69 bpm, Aktual HR = 70.0 bpm
Langkah 28: Prediksi HR = 64 bpm, Aktual HR = 69.0 bpm
Langkah 29: Prediksi HR = 61 bpm, Aktual HR = 69.0 bpm
Langkah 30: Prediksi HR = 58 bpm, Aktual HR = 68.0 bpm
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Membuat range untuk langkah prediksi</span>
<span class="n">steps_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Membuat plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps_range</span><span class="p">,</span> <span class="n">actual_hr_recursive</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual HR&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps_range</span><span class="p">,</span> <span class="n">predictions_hr_svr</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted HR (SVR)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Langkah ke Depan&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Heart Rate (bpm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Perbandingan Actual vs Predicted Heart Rate (SVR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">steps_range</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8f536f5a5dc0aa6c04444e7f2f3969679b044821791bb3eb9c5e9759f17885bf.png" src="_images/8f536f5a5dc0aa6c04444e7f2f3969679b044821791bb3eb9c5e9759f17885bf.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="c1"># Contoh grid search untuk model_hr_svr</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;scale&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span>
    <span class="s1">&#39;epsilon&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="p">}</span>

<span class="n">grid_search_hr_svr</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">),</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_absolute_percentage_error&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">grid_search_hr_svr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;hr&#39;</span><span class="p">]],</span> <span class="n">y_train_hr</span><span class="p">)</span>

<span class="n">best_model_hr_svr</span> <span class="o">=</span> <span class="n">grid_search_hr_svr</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best Parameters HR SVR: </span><span class="si">{</span><span class="n">grid_search_hr_svr</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Lakukan hal yang sama untuk model_rr_svr dan model_ecg_svr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Best Parameters HR SVR: {&#39;C&#39;: 100, &#39;epsilon&#39;: 0.1, &#39;gamma&#39;: &#39;auto&#39;}
</pre></div>
</div>
</div>
</div>
</section>
<section id="gradient-boost">
<h2>3. Gradient Boost<a class="headerlink" href="#gradient-boost" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_percentage_error</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># 1. Inisialisasi model XGBoost untuk HR, RR, dan ECGL</span>
<span class="n">model_hr_xgb</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">objective</span><span class="o">=</span><span class="s1">&#39;reg:squarederror&#39;</span><span class="p">)</span>
<span class="n">model_rr_xgb</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">objective</span><span class="o">=</span><span class="s1">&#39;reg:squarederror&#39;</span><span class="p">)</span>
<span class="n">model_ecg_xgb</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">objective</span><span class="o">=</span><span class="s1">&#39;reg:squarederror&#39;</span><span class="p">)</span>

<span class="c1"># 2. Melatih model XGBoost</span>
<span class="n">model_hr_xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;hr&#39;</span><span class="p">]],</span> <span class="n">y_train_hr</span><span class="p">)</span>
<span class="n">model_rr_xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;rr&#39;</span><span class="p">]],</span> <span class="n">y_train_rr</span><span class="p">)</span>
<span class="n">model_ecg_xgb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;ecg&#39;</span><span class="p">]],</span> <span class="n">y_train_ecg</span><span class="p">)</span>

<span class="c1"># 3. Prediksi Single-Step untuk HR dan Hitung MAPE</span>
<span class="n">y_pred_single_hr_xgb</span> <span class="o">=</span> <span class="n">model_hr_xgb</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">[:,</span> <span class="n">feature_indices</span><span class="p">[</span><span class="s1">&#39;hr&#39;</span><span class="p">]])</span>
<span class="n">y_pred_single_hr_xgb_rounded</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">y_pred_single_hr_xgb</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">mape_single_hr_xgb</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">y_test_hr</span><span class="p">,</span> <span class="n">y_pred_single_hr_xgb_rounded</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE (Single-step Prediction HR XGBoost): </span><span class="si">{</span><span class="n">mape_single_hr_xgb</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># 4. Prediksi Multi-Step Recursive dengan Memperbarui Semua Fitur Lag</span>
<span class="n">X_initial</span> <span class="o">=</span> <span class="n">X_test_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Pilih input awal</span>
<span class="n">steps</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># Tentukan jumlah langkah prediksi</span>

<span class="n">predictions_hr_xgb</span><span class="p">,</span> <span class="n">predictions_rr_xgb</span><span class="p">,</span> <span class="n">predictions_ecg_xgb</span> <span class="o">=</span> <span class="n">recursive_forecast_multi</span><span class="p">(</span>
    <span class="n">model_hr</span><span class="o">=</span><span class="n">model_hr_xgb</span><span class="p">,</span>
    <span class="n">model_rr</span><span class="o">=</span><span class="n">model_rr_xgb</span><span class="p">,</span>
    <span class="n">model_ecg</span><span class="o">=</span><span class="n">model_ecg_xgb</span><span class="p">,</span>
    <span class="n">scaler</span><span class="o">=</span><span class="n">scaler</span><span class="p">,</span>
    <span class="n">X_input</span><span class="o">=</span><span class="n">X_initial</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="n">steps</span><span class="p">,</span>
    <span class="n">feature_cols</span><span class="o">=</span><span class="n">feature_cols</span><span class="p">,</span>
    <span class="n">n_lags</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">feature_indices</span><span class="o">=</span><span class="n">feature_indices</span>
<span class="p">)</span>

<span class="c1"># 5. Hitung MAPE untuk recursive forecast HR</span>
<span class="n">actual_hr_recursive</span> <span class="o">=</span> <span class="n">y_test_hr</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="n">steps</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">mape_recursive_hr_xgb</span> <span class="o">=</span> <span class="n">mean_absolute_percentage_error</span><span class="p">(</span><span class="n">actual_hr_recursive</span><span class="p">,</span> <span class="n">predictions_hr_xgb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MAPE (Recursive Forecasting HR XGBoost): </span><span class="si">{</span><span class="n">mape_recursive_hr_xgb</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>

<span class="c1"># 6. Tampilkan Perbandingan Prediksi vs Aktual untuk HR</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Perbandingan Actual vs Predicted HR (XGBoost):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Langkah </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">: Prediksi HR = </span><span class="si">{</span><span class="n">predictions_hr_xgb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> bpm, Aktual HR = </span><span class="si">{</span><span class="n">actual_hr_recursive</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> bpm&quot;</span><span class="p">)</span>

<span class="c1"># 7. Plot Grafik Actual vs Predicted HR</span>
<span class="n">steps_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps_range</span><span class="p">,</span> <span class="n">actual_hr_recursive</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Actual HR&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps_range</span><span class="p">,</span> <span class="n">predictions_hr_xgb</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicted HR (XGBoost)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Langkah ke Depan&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Heart Rate (bpm)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Perbandingan Actual vs Predicted Heart Rate (XGBoost)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">steps_range</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MAPE (Single-step Prediction HR XGBoost): 0.07%
MAPE (Recursive Forecasting HR XGBoost): 0.03%

Perbandingan Actual vs Predicted HR (XGBoost):
Langkah 1: Prediksi HR = 72 bpm, Aktual HR = 71.0 bpm
Langkah 2: Prediksi HR = 71 bpm, Aktual HR = 73.0 bpm
Langkah 3: Prediksi HR = 71 bpm, Aktual HR = 72.0 bpm
Langkah 4: Prediksi HR = 71 bpm, Aktual HR = 71.0 bpm
Langkah 5: Prediksi HR = 71 bpm, Aktual HR = 75.0 bpm
Langkah 6: Prediksi HR = 72 bpm, Aktual HR = 73.0 bpm
Langkah 7: Prediksi HR = 71 bpm, Aktual HR = 73.0 bpm
Langkah 8: Prediksi HR = 71 bpm, Aktual HR = 75.0 bpm
Langkah 9: Prediksi HR = 71 bpm, Aktual HR = 74.0 bpm
Langkah 10: Prediksi HR = 71 bpm, Aktual HR = 74.0 bpm
Langkah 11: Prediksi HR = 72 bpm, Aktual HR = 72.0 bpm
Langkah 12: Prediksi HR = 71 bpm, Aktual HR = 71.0 bpm
Langkah 13: Prediksi HR = 72 bpm, Aktual HR = 70.0 bpm
Langkah 14: Prediksi HR = 71 bpm, Aktual HR = 70.0 bpm
Langkah 15: Prediksi HR = 71 bpm, Aktual HR = 69.0 bpm
Langkah 16: Prediksi HR = 72 bpm, Aktual HR = 69.0 bpm
Langkah 17: Prediksi HR = 71 bpm, Aktual HR = 69.0 bpm
Langkah 18: Prediksi HR = 72 bpm, Aktual HR = 70.0 bpm
Langkah 19: Prediksi HR = 71 bpm, Aktual HR = 68.0 bpm
Langkah 20: Prediksi HR = 71 bpm, Aktual HR = 70.0 bpm
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
e:\apps\anaconda3\envs\MLEnv\Lib\site-packages\sklearn\base.py:493: UserWarning: X does not have valid feature names, but MinMaxScaler was fitted with feature names
  warnings.warn(
</pre></div>
</div>
<img alt="_images/1fc236f378f15f2682b920580fa8dfcf58a579f021c9fc64678500586cf72720.png" src="_images/1fc236f378f15f2682b920580fa8dfcf58a579f021c9fc64678500586cf72720.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="kesimpulan">
<h1>Kesimpulan<a class="headerlink" href="#kesimpulan" title="Link to this heading">#</a></h1>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Model</p></th>
<th class="head"><p>MAPE</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Random Fores</p></td>
<td><p>3.89 %</p></td>
</tr>
<tr class="row-odd"><td><p>SVR</p></td>
<td><p>0.07 %</p></td>
</tr>
<tr class="row-even"><td><p>Gradient Boost</p></td>
<td><p>0.4 %</p></td>
</tr>
</tbody>
</table>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="deployment">
<h1>Deployment<a class="headerlink" href="#deployment" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">joblib</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>

<span class="c1"># Misalkan model sudah dilatih</span>
<span class="n">model_hr_svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">model_rr_svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">model_ecg_svr</span> <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Setelah model dilatih, simpan model dan scaler</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model_hr_svr</span><span class="p">,</span> <span class="s1">&#39;model_hr_svr.joblib&#39;</span><span class="p">)</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model_rr_svr</span><span class="p">,</span> <span class="s1">&#39;model_rr_svr.joblib&#39;</span><span class="p">)</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model_ecg_svr</span><span class="p">,</span> <span class="s1">&#39;model_ecg_svr.joblib&#39;</span><span class="p">)</span>

<span class="c1"># Simpan scaler</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">MinMaxScaler</span><span class="p">()</span>
<span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>  <span class="c1"># Ganti dengan data yang sesuai</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">scaler</span><span class="p">,</span> <span class="s1">&#39;scaler.joblib&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;scaler.joblib&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="website">
<h1>Website<a class="headerlink" href="#website" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="https://huggingface.co/spaces/ahmadnoval/PSD-Prediksi-detak-jantung-pasien">https://huggingface.co/spaces/ahmadnoval/PSD-Prediksi-detak-jantung-pasien</a></p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Project2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">PROYEK SAINS DATA PREDIKSI EMISI CO2 PER TAHUN NEGARA INDONESIA BERDASARKAN POLA WAKTU</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">PROYEK SAINS DATA PREDIKSI DETAK JANTUNG UNTUK DETEKSI DINI KEGAGALAN JANTUNG PASIEN KOGNESTIF BERAT</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bisnis-understading">Bisnis Understading</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#latar-belakang">1. Latar Belakang</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rumusan-masalah">2. Rumusan Masalah</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tujuan">3. Tujuan</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-collecting">Data Collecting</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ekstraksi-fitur">Ekstraksi Fitur</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-understanding">Data Understanding</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#kualitas-data">Kualitas Data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribusi-data">Distribusi data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-value">Missing Value</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#korekasi-fitur">Korekasi fitur</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#outlier">Outlier</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-prepocessing">Data Prepocessing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mengatasi-outlier">Mengatasi Outlier</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seleksi-fitur">Seleksi Fitur</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#menyiapkan-data-untuk-recursive-multi-step-forecasting">Menyiapkan Data untuk Recursive Multi-step Forecasting</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lag-fitur">Lag Fitur</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#horizon-target">Horizon / Target</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#membagi-data-train-dan-test">Membagi data train dan test</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelling">Modelling</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fungsi-rekursif-forcasts">Fungsi Rekursif Forcasts</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#random-forest-regressor">1. Random Forest Regressor</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#svr">2. SVR</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gradient-boost">3. Gradient Boost</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#kesimpulan">Kesimpulan</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#deployment">Deployment</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#website">Website</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ahmad Noval M
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>